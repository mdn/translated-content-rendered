---
title: 跨域资源共享(CORS)
slug: orphaned/Web/HTTP/跨域资源共享(CORS)_
original_slug: Web/HTTP/跨域资源共享(CORS)_
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li><a href="/zh-CN/docs/Web/HTTP"><strong><em>HTTP</em></strong></a></li>
    <li><strong>Guides:</strong></li>
    <li class="toggle">
        <details>
            <summary>Resources and URIs</summary>
            <ol>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web">Identifying resources on the Web</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">Data URIs</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_Types">Introduction to MIME Types</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types">Complete list of MIME Types</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Choosing_between_www_and_non-www_URLs">Choosing between www and non-www URLs</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP guide</summary>
            <ol>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP">Basics of HTTP</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Overview">Overview of HTTP</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Basics_of_HTTP/Evolution_of_HTTP">Evolution of HTTP</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Messages">HTTP Messages</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Session">A typical HTTP session</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Connection_management_in_HTTP_1.x">Connection management in HTTP/1.x</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Protocol_upgrade_mechanism">Protocol upgrade mechanism</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP security</summary>
            <ol>
                <li><a href="/zh-CN/docs/Web/HTTP/CSP">Content Security Policy (CSP)</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Public_Key_Pinning">HTTP Public Key Pinning (HPKP)</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Headers/Strict-Transport-Security">HTTP Strict Transport Security (HSTS)</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies">Cookie security</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a></li>
                <li><a href="/zh-CN/docs/Web/HTTP/Headers/X-XSS-Protection">X-XSS-Protection</a></li>
                <li><a href="https://wiki.mozilla.org/Security/Guidelines/Web_Security">Mozilla web security guidelines</a></li>
                <li><a href="https://observatory.mozilla.org/">Mozilla Observatory</a></li>
            </ol>
        </details>
    </li>

    <li><a href="/zh-CN/docs/Web/HTTP/CORS">HTTP access control (CORS)</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Authentication">HTTP authentication</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Caching">HTTP caching</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Compression">HTTP compression</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Conditional_requests">HTTP conditional requests</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Content_negotiation">HTTP content negotiation</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Cookies">HTTP cookies</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Range_requests">HTTP range requests</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Redirections">HTTP redirects</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Resources_and_specifications">HTTP specifications</a></li>
    <li><a href="/zh-CN/docs/Web/HTTP/Feature_Policy">Feature policy</a></li>
    <li><strong>References:</strong></li>
    <li class="toggle">
        <details>
            <summary>HTTP headers</summary>
            <ol><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept"><code>Accept</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-CH"><code>Accept-CH</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-CH-Lifetime"><code>Accept-CH-Lifetime</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Charset"><code>Accept-Charset</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Encoding"><code>Accept-Encoding</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Language"><code>Accept-Language</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Patch"><code>Accept-Patch</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Ranges"><code>Accept-Ranges</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Headers"><code>Access-Control-Allow-Headers</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Methods"><code>Access-Control-Allow-Methods</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers"><code>Access-Control-Expose-Headers</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age"><code>Access-Control-Max-Age</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Headers"><code>Access-Control-Request-Headers</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Method"><code>Access-Control-Request-Method</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Age"><code>Age</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Allow"><code>Allow</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Alt-Svc"><code>Alt-Svc</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Authorization"><code>Authorization</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Cache-Control"><code>Cache-Control</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Clear-Site-Data"><code>Clear-Site-Data</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Connection"><code>Connection</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Disposition"><code>Content-Disposition</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Encoding"><code>Content-Encoding</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Language"><code>Content-Language</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Length"><code>Content-Length</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Location"><code>Content-Location</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Range"><code>Content-Range</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only"><code>Content-Security-Policy-Report-Only</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Cookie"><code>Cookie</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Cookie2"><code>Cookie2</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy"><code>Cross-Origin-Embedder-Policy</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy"><code>Cross-Origin-Opener-Policy</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy"><code>Cross-Origin-Resource-Policy</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/DNT"><code>DNT</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/DPR"><code>DPR</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Date"><code>Date</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Device-Memory"><code>Device-Memory</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Digest"><code>Digest</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/ETag"><code>ETag</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Early-Data"><code>Early-Data</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Expect"><code>Expect</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Expect-CT"><code>Expect-CT</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Expires"><code>Expires</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy"><code>Feature-Policy</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Forwarded"><code>Forwarded</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/From"><code>From</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Host"><code>Host</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/If-Match"><code>If-Match</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/If-Modified-Since"><code>If-Modified-Since</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/If-None-Match"><code>If-None-Match</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/If-Range"><code>If-Range</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/If-Unmodified-Since"><code>If-Unmodified-Since</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Index"><code>Index</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Keep-Alive"><code>Keep-Alive</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Large-Allocation"><code>Large-Allocation</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Last-Modified"><code>Last-Modified</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Link"><code>Link</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Location"><code>Location</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/NEL"><code>NEL</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/NEL$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Origin"><code>Origin</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Pragma"><code>Pragma</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Proxy-Authenticate"><code>Proxy-Authenticate</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Proxy-Authorization"><code>Proxy-Authorization</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Public-Key-Pins"><code>Public-Key-Pins</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Public-Key-Pins-Report-Only"><code>Public-Key-Pins-Report-Only</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Range"><code>Range</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Referer"><code>Referer</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Referrer-Policy"><code>Referrer-Policy</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Save-Data"><code>Save-Data</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Sec-Fetch-Dest"><code>Sec-Fetch-Dest</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Sec-Fetch-Mode"><code>Sec-Fetch-Mode</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Sec-Fetch-Site"><code>Sec-Fetch-Site</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Sec-Fetch-User"><code>Sec-Fetch-User</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Sec-WebSocket-Accept"><code>Sec-WebSocket-Accept</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Server"><code>Server</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Server-Timing"><code>Server-Timing</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Set-Cookie"><code>Set-Cookie</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Set-Cookie2"><code>Set-Cookie2</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/SourceMap"><code>SourceMap</code></a></li><li><a href="/zh-CN/docs/Security/HTTP_Strict_Transport_Security"><code>HTTP Strict Transport Security</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/TE"><code>TE</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Timing-Allow-Origin"><code>Timing-Allow-Origin</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Tk"><code>Tk</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Trailer"><code>Trailer</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Transfer-Encoding"><code>Transfer-Encoding</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Upgrade-Insecure-Requests"><code>Upgrade-Insecure-Requests</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/User-Agent"><code>User-Agent</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Vary"><code>Vary</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Via"><code>Via</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/WWW-Authenticate"><code>WWW-Authenticate</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Want-Digest"><code>Want-Digest</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Want-Digest$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Warning"><code>Warning</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/X-Content-Type-Options"><code>X-Content-Type-Options</code></a></li><li><a href="/zh-CN/docs/Controlling_DNS_prefetching"><code>X-DNS-Prefetch-Control</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-For"><code>X-Forwarded-For</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-Host"><code>X-Forwarded-Host</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/X-Forwarded-Proto"><code>X-Forwarded-Proto</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/X-Frame-Options"><code>X-Frame-Options</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/X-XSS-Protection"><code>X-XSS-Protection</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP request methods</summary>
            <ol><li><a href="/zh-CN/docs/Web/HTTP/Methods/CONNECT"><code>CONNECT</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/DELETE"><code>DELETE</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/GET"><code>GET</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/HEAD"><code>HEAD</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/OPTIONS"><code>OPTIONS</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/PATCH"><code>PATCH</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/PUT"><code>PUT</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Methods/TRACE"><code>TRACE</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>HTTP response status codes</summary>
          <ol><li><a href="/zh-CN/docs/Web/HTTP/Status/100"><code>100 Continue</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/101"><code>101 Switching Protocol</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/103"><code>103 Early Hints</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/200"><code>200 OK</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/201"><code>201 Created</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/202"><code>202 Accepted</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/203"><code>203 Non-Authoritative Information</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/204"><code>204 No Content</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/205"><code>205 Reset Content</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/206"><code>206 Partial Content</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/300"><code>300 Multiple Choices</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/301"><code>301 Moved Permanently</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/302"><code>302 Found</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/303"><code>303 See Other</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/304"><code>304 Not Modified</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/307"><code>307 Temporary Redirect</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/308"><code>308 Permanent Redirect</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/400"><code>400 Bad Request</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/401"><code>401 Unauthorized</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/402"><code>402 Payment Required</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/403"><code>403 Forbidden</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/404"><code>404 Not Found</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/405"><code>405 Method Not Allowed</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/406"><code>406 Not Acceptable</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/407"><code>407 Proxy Authentication Required</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/408"><code>408 Request Timeout</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/409"><code>409 Conflict</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/410"><code>410 Gone</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/411"><code>411 Length Required</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/412"><code>412 Precondition Failed</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/413"><code>413 Payload Too Large</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/414"><code>414 URI Too Long</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/415"><code>415 Unsupported Media Type</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/416"><code>416 Range Not Satisfiable</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/417"><code>417 Expectation Failed</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/418"><code>418 I&apos;m a teapot</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/422"><code>422 Unprocessable Entity</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/425"><code>425 Too Early</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/426"><code>426 Upgrade Required</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/428"><code>428 Precondition Required</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/429"><code>429 Too Many Requests</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/431"><code>431 Request Header Fields Too Large</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/451"><code>451 Unavailable For Legal Reasons</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/500"><code>500 Internal Server Error</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/501"><code>501 Not Implemented</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/502"><code>502 Bad Gateway</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/503"><code>503 Service Unavailable</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/504"><code>504 Gateway Timeout</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/505"><code>505 HTTP Version Not Supported</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/506"><code>506 Variant Also Negotiates</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/507"><code>507 Insufficient Storage</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/508"><code>508 Loop Detected</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/510"><code>510 Not Extended</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Status/511"><code>511 Network Authentication Required</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>CSP directives</summary>
          <ol><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/base-uri"><code>CSP: base-uri</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/block-all-mixed-content"><code>CSP: block-all-mixed-content</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/child-src"><code>CSP: child-src</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src"><code>CSP: connect-src</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/default-src"><code>CSP: default-src</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/font-src"><code>CSP: font-src</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/form-action"><code>CSP: form-action</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors"><code>CSP: frame-ancestors</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src"><code>CSP: frame-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/img-src"><code>CSP: img-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/img-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src"><code>CSP: manifest-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/media-src"><code>CSP: media-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/media-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/navigate-to"><code>CSP: navigate-to</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/navigate-to$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/object-src"><code>CSP: object-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/object-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types"><code>CSP: plugin-types</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/prefetch-src"><code>CSP: prefetch-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/prefetch-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/referrer"><code>CSP: referrer</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/referrer$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/report-to"><code>report-to</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri"><code>CSP: report-uri</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/require-sri-for"><code>CSP: require-sri-for</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox"><code>CSP: sandbox</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/script-src"><code>CSP: script-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/script-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/script-src-attr"><code>CSP: script-src-attr</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/script-src-attr$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/script-src-elem"><code>CSP: script-src-elem</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src"><code>CSP: style-src</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-attr"><code>CSP: style-src-attr</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-attr$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-elem"><code>CSP: style-src-elem</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-elem$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types"><code>CSP: trusted-types</code></a> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests"><code>CSP: upgrade-insecure-requests</code></a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy/worker-src"><code>CSP: worker-src</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>CORS errors</summary>
          <ol><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSDisabled">Reason: CORS disabled</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSAllowOriginNotMatchingOrigin">原因：CORS 头 &apos;Access-Control-Allow-Origin&apos;与&apos;xyz&apos;不匹配</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin">Reason: CORS header &apos;Access-Control-Allow-Origin&apos; missing</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSOriginHeaderNotAdded">Reason: CORS header ‘Origin’ cannot be added</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSPreflightDidNotSucceed">Reason: CORS preflight channel did not succeed</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSDidNotSucceed">Reason: CORS request did not succeed</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSExternalRedirectNotAllowed">Reason: CORS request external redirect not allowed</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp">原因：CORS 请求不是 HTTP</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials">Reason: Credential is not supported if the CORS header ‘Access-Control-Allow-Origin’ is ‘*’</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSMethodNotFound">Reason: Did not find method in CORS header ‘Access-Control-Allow-Methods’</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSMultipleAllowOriginNotAllowed">Reason: Multiple CORS header &apos;Access-Control-Allow-Origin&apos; not allowed</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORS%E9%94%99%E8%AF%AF%E5%85%81%E8%AE%B8%E5%87%AD%E8%AF%81">故：在CORS头Access-Control-Allow-Credentials中预期为true</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowHeader">Reason: invalid token ‘xyz’ in CORS header ‘Access-Control-Allow-Headers’</a> <a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowHeader$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowMethod">Reason: invalid token ‘xyz’ in CORS header ‘Access-Control-Allow-Methods’</a> <a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowMethod$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSMissingAllowHeaderFromPreflight">Reason: missing token ‘xyz’ in CORS header ‘Access-Control-Allow-Headers’ from CORS preflight channel</a> <a href="/zh-CN/docs/Web/HTTP/CORS/Errors/CORSMissingAllowHeaderFromPreflight$translate" style="opacity: 0.5;">[我来译!]</a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>Feature-Policy directives</summary>
          <ol><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/accelerometer">Feature-Policy: accelerometer</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/accelerometer$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/ambient-light-sensor">Feature-Policy: ambient-light-sensor</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/ambient-light-sensor$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/autoplay">Feature-Policy: autoplay</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/battery">Feature-Policy: battery</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/battery$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/camera">Feature-Policy: camera</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/display-capture">Feature-Policy: display-capture</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/display-capture$translate" style="opacity: 0.5;">[我来译!]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/document-domain">Feature-Policy: document-domain</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/document-domain$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/encrypted-media">Feature-Policy: encrypted-media</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/encrypted-media$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/fullscreen">Feature-Policy: fullscreen</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/fullscreen$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/geolocation">Feature-Policy: geolocation</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/geolocation$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/gyroscope">Feature-Policy: gyroscope</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/gyroscope$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/layout-animations">Feature-Policy: layout-animations</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/layout-animations$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/legacy-image-formats">Feature-Policy: legacy-image-formats</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/legacy-image-formats$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/magnetometer">Feature-Policy: magnetometer</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/magnetometer$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/microphone">Feature-Policy: microphone</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/microphone$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/midi">Feature-Policy: midi</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/midi$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/oversized-images">Feature-Policy: oversized-images</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/oversized-images$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/payment">Feature-Policy: payment</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/payment$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/picture-in-picture">Feature-Policy: picture-in-picture</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/picture-in-picture$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/publickey-credentials-get">Feature-Policy: publickey-credentials-get</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/publickey-credentials-get$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/screen-wake-lock">Feature-Policy: screen-wake-lock</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/screen-wake-lock$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/sync-xhr">Feature-Policy: sync-xhr</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/sync-xhr$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/unoptimized-images">Feature-Policy: unoptimized-images</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/unoptimized-images$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/unsized-media">Feature-Policy: unsized-media</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/unsized-media$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/usb">Feature-Policy: usb</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/usb$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/vibrate">Feature-Policy: vibrate</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/vibrate$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/vr">Feature-Policy: vr</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/vr$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/wake-lock">Feature-Policy: wake-lock</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/wake-lock$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/xr">Feature-Policy: xr</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/xr$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/xr-spatial-tracking">Feature-Policy: xr-spatial-tracking</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/xr-spatial-tracking$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/web-share">web-share</a> <a href="/zh-CN/docs/Web/HTTP/Headers/Feature-Policy/web-share$translate" style="opacity: 0.5;">[我来译!]</a></li></ol>
        </details>
    </li>
  </ol>
</section></div>

<div></div>

<div><span class="seoSummary">跨域资源共享(<a href="/zh-CN/docs/Glossary/CORS">CORS</a>) 是一种机制，它使用额外的 <a href="/zh-CN/docs/Glossary/HTTP">HTTP</a> 头来告诉浏览器  让运行在一个 origin (domain) 上的Web应用被准许访问来自不同源服务器上的指定的资源。</span>当一个资源从与该资源本身所在的服务器<strong>不同的域、协议或端口</strong>请求一个资源时，资源会发起一个<strong>跨域 HTTP 请求</strong>。</div>

<div></div>

<div>比<font>如，站点 http://domain-a.com 的某 HTML 页面通过 <a href="/zh-CN/docs/Web/HTML/Element/Img#Attributes">&lt;img&gt; 的 src </a>请求 http://domain-b.com/image.jpg。网络</font>上的许多页面都会加载来自不同域的CSS样式表，图像和脚本等资源。</div>

<div></div>

<p>出于安全原因，浏览器限制从脚本内发起的跨源HTTP请求。 例如，XMLHttpRequest和Fetch API遵循同源策略。 这意味着使用这些API的Web应用程序只能从加载应用程序的同一个域请求HTTP资源，除非响应报文包含了正确CORS响应头。</p>

<p>  （译者注：这段描述不准确，并不一定是浏览器限制了发起跨站请求，也可能是跨站请求可以正常发起，但是返回结果被浏览器拦截了。）</p>

<p><img alt src="https://mdn.mozillademos.org/files/14295/CORS_principle.png" style="height: 305px; width: 440px;"></p>

<p>跨域资源共享（ <a href="/zh-CN/docs/Glossary/CORS">CORS</a> ）机制允许 Web 应用服务器进行跨域访问控制，从而使跨域数据传输得以安全进行。现代浏览器支持在 API 容器中（例如 <a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> 或 <a href="/en-US/docs/Web/API/Fetch_API">Fetch</a> ）使用 CORS，以降低跨域 HTTP 请求所带来的风险。</p>

<h2 id="谁应该读这篇文章？">谁应该读这篇文章？</h2>

<p>说实话，每个人。</p>

<p>更具体地来讲，这篇文章适用于网站管理员、后端和前端开发者。现代浏览器处理跨域资源共享的客户端部分，包括HTTP头和相关策略的执行。但是这一新标准意味着服务器需要处理新的请求头和响应头。对于服务端的支持，开发者可以阅读补充材料 <a class="internal" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Server-Side_Access_Control" title="En/Server-Side Access Control">cross-origin sharing from a server perspective (with PHP code snippets)</a> 。</p>

<h2 id="什么情况下需要_CORS_？">什么情况下需要 CORS ？</h2>

<p>跨域资源共享标准（ <a class="external external-icon" href="http://www.w3.org/TR/cors/" title="http://www.w3.org/TR/cors/">cross-origin sharing standard</a> ）允许在下列场景中使用跨域 HTTP 请求：</p>

<ul>
 <li>前文提到的由 <a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> 或 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch</a> 发起的跨域 HTTP 请求。</li>
 <li>Web 字体 (CSS 中通过<code> @font-face </code>使用跨域字体资源), <a class="external external-icon" href="http://www.webfonts.info/wiki/index.php?title=%40font-face_support_in_Firefox">因此，网站就可以发布 TrueType 字体资源，并只允许已授权网站进行跨站调用</a>。</li>
 <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL">WebGL 贴图</a></li>
 <li>使用 <code><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage">drawImage</a></code> 将 Images/video 画面绘制到 canvas</li>
</ul>

<p>本文概述了跨域资源共享机制及其所涉及的 HTTP 头。</p>

<h2 id="功能概述">功能概述</h2>

<p>跨域资源共享标准新增了一组 HTTP 首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源。另外，规范要求，对那些可能对服务器数据产生副作用的 HTTP 请求方法（特别是 <a href="/zh-CN/docs/Web/HTTP/Methods/GET" title="HTTP GET 方法请求指定的资源。使用 GET 的请求应该只用于获取数据。"><code>GET</code></a> 以外的 HTTP 请求，或者搭配某些 MIME 类型的 <a href="/zh-CN/docs/Web/HTTP/Methods/POST" title="HTTP POST 方法 发送数据给服务器. 请求主体的类型由 Content-Type 首部指定."><code>POST</code></a> 请求），浏览器必须首先使用 <a href="/zh-CN/docs/Web/HTTP/Methods/OPTIONS" title="HTTP 的 OPTIONS 方法 用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为“*”）使用该方法。"><code>OPTIONS</code></a> 方法发起一个预检请求（preflight request），从而获知服务端是否允许该跨域请求。服务器确认允许之后，才发起实际的 HTTP 请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证（包括 <a href="/zh-CN/docs/Web/HTTP/Cookies">Cookies </a>和 HTTP 认证相关数据）。</p>

<p>CORS请求失败会产生错误，但是为了安全，在JavaScript代码层面是无法获知到底具体是哪里出了问题。你只能查看浏览器的控制台以得知具体是哪里出现了错误。</p>

<p>接下来的内容将讨论相关场景，并剖析该机制所涉及的 HTTP 首部字段。</p>

<h2 id="若干访问控制场景">若干访问控制场景</h2>

<p>这里，我们使用三个场景来解释跨域资源共享机制的工作原理。这些例子都使用 <a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> 对象。</p>

<p>本文中的 JavaScript 代码片段都可以从 <a href="http://arunranga.com/examples/access-control/">http://arunranga.com/examples/access-control/</a> 获得。另外，使用支持跨域  <a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> 的浏览器访问该地址，可以看到代码的实际运行结果。</p>

<p>关于服务端对跨域资源共享的支持的讨论，请参见这篇文章： <a href="/zh-CN/docs/Web/HTTP/Server-Side_Access_Control">Server-Side_Access_Control (CORS)</a>。</p>

<h3 id="简单请求">简单请求</h3>

<p>某些请求不会触发 <a href="/zh-CN/docs/Web/HTTP/Access_control_CORS#Preflighted_requests">CORS 预检请求</a>。本文称这样的请求为“简单请求”，请注意，该术语并不属于 <a class="external" href="https://fetch.spec.whatwg.org/" hreflang="en" lang="en" title="Fetch">Fetch</a> （其中定义了 CORS）规范。若请求满足所有下述条件，则该请求可视为“简单请求”：</p>

<ul>
 <li>使用下列方法之一：
  <ul>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/GET"><code>GET</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/HEAD"><code>HEAD</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a></li>
  </ul>
 </li>
 <li><span class="short_text" id="result_box" lang="zh-CN"><span>Fetch 规范定义了</span></span><a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header">对 CORS 安全的首部字段集合</a>，不得人为设置该集合之外的其他首部字段。该集合为：
  <ul>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept"><code>Accept</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Language"><code>Accept-Language</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Language"><code>Content-Language</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> （需要注意额外的限制）</li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#dpr">DPR</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#downlink">Downlink</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#save-data">Save-Data</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#viewport-width">Viewport-Width</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#width">Width</a></code></li>
  </ul>
 </li>
 <li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> 的值仅限于下列三者之一：
  <ul>
   <li><code>text/plain</code></li>
   <li><code>multipart/form-data</code></li>
   <li><code>application/x-www-form-urlencoded</code></li>
  </ul>
 </li>
 <li>请求中的任意<a href="/zh-CN/docs/Web/API/XMLHttpRequestUpload"><code>XMLHttpRequestUpload</code></a> 对象均没有注册任何事件监听器；<a href="/zh-CN/docs/Web/API/XMLHttpRequestUpload"><code>XMLHttpRequestUpload</code></a> 对象可以使用 <a href="/zh-CN/docs/Web/API/XMLHttpRequest/upload"><code>XMLHttpRequest.upload</code></a> 属性访问。</li>
 <li>请求中没有使用 <a href="/zh-CN/docs/Web/API/ReadableStream"><code>ReadableStream</code></a> 对象。</li>
</ul>

<div class="note notecard"><strong>注意:</strong> 这些跨域请求与浏览器发出的其他跨域请求并无二致。如果服务器未返回正确的响应首部，则请求方不会收到任何数据。因此，那些不允许跨域请求的网站无需为这一新的 HTTP 访问控制特性担心。</div>

<div class="note notecard"><strong>注意:</strong> WebKit Nightly 和 Safari Technology Preview 为<a href="/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知（服务器）客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。"><code>Accept</code></a>, <a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language 请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用 Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生（因为可增加指纹独特性，通常也不被鼓励）（译者注：通常只在测试网站的多语言支持时手动修改它；或为进一步减少指纹独特性，改为最常见的英文）。"><code>Accept-Language</code></a>, 和 <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。"><code>Content-Language</code></a> 首部字段的值添加了额外的限制。如果这些首部字段的值是“非标准”的，WebKit/Safari 就不会将这些请求视为“简单请求”。WebKit/Safari 并没有在文档中列出哪些值是“非标准”的，不过我们可以在这里找到相关讨论：<a href="https://bugs.webkit.org/show_bug.cgi?id=165178" rel="nofollow noreferrer">Require preflight for non-standard CORS-safelisted request headers Accept, Accept-Language, and Content-Language</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=165566" rel="nofollow noreferrer">Allow commas in Accept, Accept-Language, and Content-Language request headers for simple CORS</a>, and <a href="https://bugs.webkit.org/show_bug.cgi?id=166363" rel="nofollow noreferrer">Switch to a blacklist model for restricted Accept headers in simple CORS requests</a>。其它浏览器并不支持这些额外的限制，因为它们不属于规范的一部分。</div>

<p>比如说，假如站点 http://foo.example 的网页应用想要访问 http://bar.other 的资源。http://foo.example 的网页中可能包含类似于下面的 JavaScript 代码：</p>

<pre class="brush: js notranslate" id="line1">var invocation = new XMLHttpRequest();
var url = &apos;http://bar.other/resources/public-data/&apos;;

function callOtherDomain() {
  if(invocation) {
    invocation.open(&apos;GET&apos;, url, true);
    invocation.onreadystatechange = handler;
    invocation.send();
  }
}
</pre>

<p><span class="short_text" id="result_box" lang="zh-CN"><span>客户端和服务器之间使用 CORS 首部字段来处理跨域权限：</span></span></p>

<p><img alt src="https://mdn.mozillademos.org/files/14293/simple_req.png" style="height: 224px; width: 521px;"></p>

<p>分别检视请求报文和响应报文：</p>

<pre class="brush: shell notranslate">GET /resources/public-data/ HTTP/1.1
Host: bar.other
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko/20081130 Minefield/3.1b3pre
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection: keep-alive
Referer: http://foo.example/examples/access-control/simpleXSInvocation.html
Origin: http://foo.example


HTTP/1.1 200 OK
Date: Mon, 01 Dec 2008 00:23:53 GMT
Server: Apache/2.0.61
Access-Control-Allow-Origin: *
Keep-Alive: timeout=2, max=100
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: application/xml

[XML Data]
</pre>

<p>第 1~10 行是请求首部。第10行 的请求首部字段 <a href="/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段 Origin 指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。"><code>Origin</code></a> 表明该请求来源于 <code>http://foo.example</code>。</p>

<p>第 13~22 行是来自于 http://bar.other 的服务端响应。响应中携带了响应首部字段 <a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置："><code>Access-Control-Allow-Origin</code></a>（第 16 行）。使用 <a href="/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段 Origin 指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。"><code>Origin</code></a> 和 <a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置："><code>Access-Control-Allow-Origin</code></a> 就能完成最简单的访问控制。本例中，服务端返回的 <code>Access-Control-Allow-Origin: *</code> 表明，该资源可以被<strong>任意</strong>外域访问。如果服务端仅允许来自 http://foo.example 的访问，该首部字段的内容如下：</p>

<p><code>Access-Control-Allow-Origin: http://foo.example</code></p>

<p>现在，除了 http://foo.example，其它外域均不能访问该资源（该策略由请求首部中的 ORIGIN 字段定义，见第10行）。<code>Access-Control-Allow-Origin</code> 应当为 * 或者包含由 Origin 首部字段所指明的域名。</p>

<h3 id="预检请求">预检请求</h3>

<p>与前述简单请求不同，“需预检的请求”要求必须首先使用 <a href="/zh-CN/docs/Web/HTTP/Methods/OPTIONS" title="HTTP 的 OPTIONS 方法 用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为“*”）使用该方法。"><code>OPTIONS</code></a>   方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。&quot;预检请求“的使用，可以避免跨域请求对服务器的用户数据产生未预期的影响。</p>

<p>当请求满足下述任一条件时，即应首先发送预检请求：</p>

<ul>
 <li>使用了下面任一 HTTP 方法：
  <ul>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/PUT"><code>PUT</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/DELETE"><code>DELETE</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/CONNECT"><code>CONNECT</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/OPTIONS"><code>OPTIONS</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/TRACE"><code>TRACE</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Methods/PATCH"><code>PATCH</code></a></li>
  </ul>
 </li>
 <li>人为设置了<a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header">对 CORS 安全的首部字段集合</a>之外的其他首部字段。该集合为：
  <ul>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept"><code>Accept</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Language"><code>Accept-Language</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Language"><code>Content-Language</code></a></li>
   <li><a href="/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> (需要注意额外的限制)</li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#dpr">DPR</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#downlink">Downlink</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#save-data">Save-Data</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#viewport-width">Viewport-Width</a></code></li>
   <li><code><a href="http://httpwg.org/http-extensions/client-hints.html#width">Width</a></code></li>
  </ul>
 </li>
 <li> <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> 的值不属于下列之一:
  <ul>
   <li><code>application/x-www-form-urlencoded</code></li>
   <li><code>multipart/form-data</code></li>
   <li><code>text/plain</code></li>
  </ul>
 </li>
 <li>请求中的<a href="/zh-CN/docs/Web/API/XMLHttpRequestUpload"><code>XMLHttpRequestUpload</code></a> 对象注册了任意多个事件监听器。</li>
 <li>请求中使用了<a href="/zh-CN/docs/Web/API/ReadableStream"><code>ReadableStream</code></a>对象。</li>
</ul>

<div class="note notecard">
<p><strong>注意:</strong> WebKit Nightly 和 Safari Technology Preview 为<a href="/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知（服务器）客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。"><code>Accept</code></a>, <a href="/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language 请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用 Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生（因为可增加指纹独特性，通常也不被鼓励）（译者注：通常只在测试网站的多语言支持时手动修改它；或为进一步减少指纹独特性，改为最常见的英文）。"><code>Accept-Language</code></a>, 和 <a href="/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。"><code>Content-Language</code></a> 首部字段的值添加了额外的限制。如果这些首部字段的值是“非标准”的，WebKit/Safari 就不会将这些请求视为“简单请求”。WebKit/Safari 并没有在文档中列出哪些值是“非标准”的，不过我们可以在这里找到相关讨论：<a href="https://bugs.webkit.org/show_bug.cgi?id=165178" rel="nofollow noreferrer">Require preflight for non-standard CORS-safelisted request headers Accept, Accept-Language, and Content-Language</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=165566" rel="nofollow noreferrer">Allow commas in Accept, Accept-Language, and Content-Language request headers for simple CORS</a>, and <a href="https://bugs.webkit.org/show_bug.cgi?id=166363" rel="nofollow noreferrer">Switch to a blacklist model for restricted Accept headers in simple CORS requests</a>。其它浏览器并不支持这些额外的限制，因为它们不属于规范的一部分。</p>
</div>

<p>如下是一个需要执行预检请求的 HTTP 请求：</p>

<pre class="brush: js notranslate">var invocation = new XMLHttpRequest();
var url = &apos;http://bar.other/resources/post-here/&apos;;
var body = &apos;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;&apos;;

function callOtherDomain(){
  if(invocation)
    {
      invocation.open(&apos;POST&apos;, url, true);
      invocation.setRequestHeader(&apos;X-PINGOTHER&apos;, &apos;pingpong&apos;);
      invocation.setRequestHeader(&apos;Content-Type&apos;, &apos;application/xml&apos;);
      invocation.onreadystatechange = handler;
      invocation.send(body);
    }
}

......
</pre>

<p>上面的代码使用 POST 请求发送一个 XML 文档，该请求包含了一个自定义的请求首部字段（X-PINGOTHER: pingpong）。另外，该请求的 Content-Type 为 application/xml。因此，该请求需要首先发起“预检请求”。</p>

<p><img alt src="https://mdn.mozillademos.org/files/16753/preflight_correct.png" style="height: 553px; width: 521px;"></p>

<pre class="notranslate">OPTIONS /resources/post-here/ HTTP/1.1
Host: bar.other
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko/20081130 Minefield/3.1b3pre
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection: keep-alive
Origin: http://foo.example
Access-Control-Request-Method: POST
Access-Control-Request-Headers: X-PINGOTHER, Content-Type


HTTP/1.1 200 OK
Date: Mon, 01 Dec 2008 01:15:39 GMT
Server: Apache/2.0.61 (Unix)
Access-Control-Allow-Origin: http://foo.example
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: X-PINGOTHER, Content-Type
Access-Control-Max-Age: 86400
Vary: Accept-Encoding, Origin
Content-Encoding: gzip
Content-Length: 0
Keep-Alive: timeout=2, max=100
Connection: Keep-Alive
Content-Type: text/plain</pre>

<p>预检请求完成之后，发送实际请求：</p>

<pre class="notranslate"><code>POST /resources/post-here/ HTTP/1.1
Host: bar.other
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko/20081130 Minefield/3.1b3pre
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection: keep-alive
X-PINGOTHER: pingpong
Content-Type: text/xml; charset=UTF-8
Referer: http://foo.example/examples/preflightInvocation.html
Content-Length: 55
Origin: http://foo.example
Pragma: no-cache
Cache-Control: no-cache

&lt;?xml version=&quot;1.0&quot;?&gt;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;


HTTP/1.1 200 OK
Date: Mon, 01 Dec 2008 01:15:40 GMT
Server: Apache/2.0.61 (Unix)
Access-Control-Allow-Origin: http://foo.example
Vary: Accept-Encoding, Origin
Content-Encoding: gzip
Content-Length: 235
Keep-Alive: timeout=2, max=99
Connection: Keep-Alive
Content-Type: text/plain

[Some GZIP&apos;d payload]</code></pre>

<p>浏览器检测到，从 JavaScript 中发起的请求需要被预检。从上面的报文中，我们看到，第 1~12 行发送了一个使用 <code>OPTIONS 方法的“</code>预检请求<code>”。</code> OPTIONS 是 HTTP/1.1 协议中定义的方法，用以从服务器获取更多信息。该方法不会对服务器资源产生影响。 预检请求中同时携带了下面两个首部字段：</p>

<pre class="notranslate"><code>Access-Control-Request-Method: POST
Access-Control-Request-Headers: X-PINGOTHER, Content-Type</code></pre>

<p><code>首部字段 Access-Control-Request-Method 告知服务器，实际请求将使用 POST 方法。<font face="Open Sans, Arial, sans-serif">首部字段 </font></code><code><code>Access-Control-Request-Headers 告知服务器，实际请求将携带两个自定义请求首部字段：<code>X-PINGOTHER 与 Content-Type。服务器据此决定，该实际请求是否被允许。</code></code></code></p>

<p>第14~26 行为预检请求的响应，表明服务器将接受后续的实际请求。重点看第 17~20 行：</p>

<pre class="notranslate"><code>Access-Control-Allow-Origin: http://foo.example
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: X-PINGOTHER, Content-Type
Access-Control-Max-Age: 86400</code></pre>

<p><font face="Open Sans, Arial, sans-serif">首部字段</font><code><font face="Open Sans, Arial, sans-serif"> </font>Access-Control-Allow-Methods </code>表明服务器允许客户端使用<code> </code><code>POST,</code> <code>GET </code>和 <code>OPTIONS</code> 方法发起请求。该字段与 <a class="external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7" title="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7">HTTP/1.1 Allow: response header</a> 类似，但仅限于在需要访问控制的场景中使用。</p>

<p>首部字段 <code>Access-Control-Allow-Headers </code>表明服务器允许请求中携带字段 <code><code>X-PINGOTHER </code></code>与<code><code> Content-Type</code></code>。<font face="Open Sans, Arial, sans-serif">与</font><code><code><font face="Open Sans, Arial, sans-serif"> </font></code></code><code>Access-Control-Allow-Methods </code>一样，<code><code>Access-Control-Allow-Headers</code></code> 的值为逗号分割的列表。</p>

<p>最后，首部字段 <code>Access-Control-Max-Age</code> 表明该响应的有效时间为 86400 秒，也就是 24 小时。在有效时间内，浏览器无须为同一请求再次发起预检请求。请注意，浏览器自身维护了一个最大有效时间，如果该首部字段的值超过了最大有效时间，将不会生效。</p>

<h4 id="预检请求与重定向">预检请求与重定向</h4>

<p>大多数浏览器不支持针对于预检请求的重定向。如果一个预检请求发生了重定向，浏览器将报告错误：</p>

<blockquote>
<p>The request was redirected to &apos;https://example.com/foo&apos;, which is disallowed for cross-origin requests that require preflight</p>
</blockquote>

<blockquote>
<p>Request requires preflight, which is disallowed to follow cross-origin redirect</p>
</blockquote>

<p>CORS 最初要求该行为，不过<a href="https://github.com/whatwg/fetch/commit/0d9a4db8bc02251cc9e391543bb3c1322fb882f2">在后续的修订中废弃了这一要求</a>。</p>

<p>在浏览器的实现跟上规范之前，有两种方式规避上述报错行为：</p>

<ul>
 <li>在服务端去掉对预检请求的重定向；</li>
 <li>将实际请求变成一个简单请求。</li>
</ul>

<p>如果上面两种方式难以做到，我们仍有其他办法：</p>

<ul>
 <li>发出一个简单请求（使用  <a href="/en-US/docs/Web/API/Response/url">Response.url</a> 或 <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL">XHR.responseURL</a>）以判断真正的预检请求会返回什么地址。</li>
 <li>发出另一个请求（真正的请求），使用在上一步通过<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/url">Response.url</a> 或 <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL">XMLHttpRequest.responseURL</a>获得的URL。</li>
</ul>

<p>不过，如果请求是由于存在 Authorization 字段而引发了预检请求，则这一方法将无法使用。这种情况只能由服务端进行更改。</p>

<h3 id="附带身份凭证的请求">附带身份凭证的请求</h3>

<p><a href="/en-US/docs/Web/API/Fetch_API">Fetch</a> 与 CORS 的一个有趣的特性是，可以基于  <a href="/en-US/docs/Web/HTTP/Cookies">HTTP cookies</a> 和 HTTP 认证信息发送身份凭证。一般而言，对于跨域 <a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> 或 <a href="/en-US/docs/Web/API/Fetch_API">Fetch</a> 请求，浏览器<strong>不会</strong>发送身份凭证信息。如果要发送凭证信息，需要设置 <code><a class="internal" href="/en/DOM/XMLHttpRequest" title="En/XMLHttpRequest">XMLHttpRequest</a> </code>的某个特殊标志位。</p>

<p><code class="plain">本例中，http://foo.example 的某脚本向 <code class="plain">http://bar.other 发起一个GET 请求，并设置 Cookies：</code></code></p>

<pre id="line1"><code>var invocation = new XMLHttpRequest();
var url = &apos;http://bar.other/resources/credentialed-content/&apos;;

function callOtherDomain(){
  if(invocation) {
    invocation.open(&apos;GET&apos;, url, true);
    invocation.withCredentials = true;
    invocation.onreadystatechange = handler;
    invocation.send();
  }
}</code></pre>

<p>第 7 行将 <code><a class="internal" href="/en/DOM/XMLHttpRequest" title="En/XMLHttpRequest">XMLHttpRequest</a> </code>的 <code>withCredentials 标志设置为 true，</code>从而向服务器发送 Cookies。因为这是一个简单 GET 请求，所以浏览器不会对其发起“预检请求”。但是，如果服务器端的响应中未携带 <code>Access-Control-Allow-Credentials: true ，浏览器将不会把响应内容返回给请求的发送者。</code></p>

<p><img alt src="https://mdn.mozillademos.org/files/14291/cred-req.png"></p>

<p>客户端与服务器端交互示例如下：</p>

<pre class="notranslate"><code>GET /resources/access-control-with-credentials/ HTTP/1.1
Host: bar.other
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko/20081130 Minefield/3.1b3pre
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection: keep-alive
Referer: http://foo.example/examples/credential.html
Origin: http://foo.example
Cookie: pageAccess=2


HTTP/1.1 200 OK
Date: Mon, 01 Dec 2008 01:34:52 GMT
Server: Apache/2.0.61 (Unix) PHP/4.4.7 mod_ssl/2.0.61 OpenSSL/0.9.7e mod_fastcgi/2.4.2 DAV/2 SVN/1.4.2
X-Powered-By: PHP/5.2.6
Access-Control-Allow-Origin: http://foo.example
Access-Control-Allow-Credentials: true
Cache-Control: no-cache
Pragma: no-cache
Set-Cookie: pageAccess=3; expires=Wed, 31-Dec-2008 01:34:53 GMT
Vary: Accept-Encoding, Origin
Content-Encoding: gzip
Content-Length: 106
Keep-Alive: timeout=2, max=100
Connection: Keep-Alive
Content-Type: text/plain


[text/plain payload]</code></pre>

<p>即使第 11 行指定了 Cookie 的相关信息，但是，如果 bar.other 的响应中缺失 <a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" title="Access-Control-Allow-Credentials 响应头表示是否可以将对请求的响应暴露给页面。返回true则可以，其他值均不可以。"><code>Access-Control-Allow-Credentials</code></a><code>: true（</code>第 19 行），则响应内容不会返回给请求的发起者。</p>

<h4 id="附带身份凭证的请求与通配符">附带身份凭证的请求与通配符</h4>

<p>对于附带身份凭证的请求，服务器不得设置 <code style="font-style: normal;">Access-Control-Allow-Origin 的值为“*”。</code></p>

<p><code style="font-style: normal;">这是因为请求的首部中携带了 Cookie 信息，如果 Access-Control-Allow-Origin 的值为“*”，请求将会失败。而将 Access-Control-Allow-Origin 的值设置为 </code>http://foo.example，则请求将成功执行。</p>

<p>另外，响应首部中也携带了 Set-Cookie 字段，尝试对 Cookie 进行修改。如果操作失败，将会抛出异常。</p>

<h2 id="HTTP_响应首部字段">HTTP 响应首部字段</h2>

<p>本节列出了规范所定义的响应首部字段。上一小节中，我们已经看到了这些首部字段在实际场景中是如何工作的。</p>

<h3 id="Access-Control-Allow-Origin">Access-Control-Allow-Origin</h3>

<p>响应首部中可以携带一个 <a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置："><code>Access-Control-Allow-Origin</code></a><code style="font-style: normal;"> 字段，其语法如下:</code></p>

<pre class="notranslate">Access-Control-Allow-Origin: &lt;origin&gt; | *
</pre>

<p>其中，origin 参数的值指定了允许访问该资源的外域 URI。对于不需要携带身份凭证的请求，服务器可以指定该字段的值为通配符，表示允许来自所有域的请求。</p>

<p>例如，下面的字段值将允许来自 http://mozilla.com 的请求：</p>

<pre class="notranslate">Access-Control-Allow-Origin: <span class="plain">http://mozilla.com</span></pre>

<p>如果服务端指定了具体的域名而非“*”，那么响应首部中的 Vary 字段的值必须包含 Origin。这将告诉客户端：服务器对不同的源站返回不同的内容。</p>

<h3 id="Access-Control-Expose-Headers">Access-Control-Expose-Headers</h3>

<p>译者注：在跨域访问时，XMLHttpRequest对象的getResponseHeader()方法只能拿到一些最基本的响应头，Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma，如果要访问其他头，则需要服务器设置本响应头。</p>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers" title="响应首部 Access-Control-Expose-Headers 列出了哪些首部可以作为响应的一部分暴露给外部。"><code>Access-Control-Expose-Headers</code></a> 头让服务器把允许浏览器访问的头放入白名单，例如：</p>

<pre class="notranslate">Access-Control-Expose-Headers: X-My-Custom-Header, X-Another-Custom-Header
</pre>

<p>这样浏览器就能够通过getResponseHeader访问<code>X-My-Custom-Header</code>和 <code>X-Another-Custom-Header</code> 响应头了。</p>

<h3 id="Access-Control-Max-Age">Access-Control-Max-Age</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age" title="The Access-Control-Max-Age 这个响应头表示 preflight request  （预检请求）的返回结果（即 Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息） 可以被缓存多久。"><code>Access-Control-Max-Age</code></a> 头指定了preflight请求的结果能够被缓存多久，请参考本文在前面提到的preflight例子。</p>

<pre class="notranslate">Access-Control-Max-Age: &lt;delta-seconds&gt;
</pre>

<p><code>delta-seconds</code> 参数表示preflight请求的结果在多少秒内有效。</p>

<h3 id="Access-Control-Allow-Credentials">Access-Control-Allow-Credentials</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" title="Access-Control-Allow-Credentials 响应头表示是否可以将对请求的响应暴露给页面。返回true则可以，其他值均不可以。"><code>Access-Control-Allow-Credentials</code></a> 头指定了当浏览器的<code>credentials</code>设置为true时是否允许浏览器读取response的内容。当用在对preflight预检测请求的响应中时，它指定了实际的请求是否可以使用<code>credentials</code>。请注意：简单 GET 请求不会被预检；如果对此类请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页。</p>

<pre class="notranslate">Access-Control-Allow-Credentials: true
</pre>

<p>上文已经讨论了<a href="#Requests_with_credentials">附带身份凭证的请求</a>。</p>

<h3 id="Access-Control-Allow-Methods">Access-Control-Allow-Methods</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Methods" title="响应首部 Access-Control-Allow-Methods 在对 preflight request.（预检请求）的应答中明确了客户端所要访问的资源允许使用的方法或方法列表。"><code>Access-Control-Allow-Methods</code></a> 首部字段用于预检请求的响应。其指明了实际请求所允许使用的 HTTP 方法。</p>

<pre class="notranslate">Access-Control-Allow-Methods: &lt;method&gt;[, &lt;method&gt;]*
</pre>

<p>相关示例见<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS$edit#Preflighted_requests">这里</a>。</p>

<h3 id="Access-Control-Allow-Headers">Access-Control-Allow-Headers</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Headers" title="响应首部 Access-Control-Allow-Headers 用于 {{glossary(&quot;preflight request&quot;)}} （预检请求）中，列出了将会在正式请求的 {{HTTPHeader(&quot;Access-Control-Request-Headers&quot;)}} 字段中出现的首部信息。"><code>Access-Control-Allow-Headers</code></a> 首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字段。</p>

<pre class="notranslate">Access-Control-Allow-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*
</pre>

<h2 id="HTTP_请求首部字段">HTTP 请求首部字段</h2>

<p>本节列出了可用于发起跨域请求的首部字段。请注意，这些首部字段无须手动设置。 当开发者使用 XMLHttpRequest 对象发起跨域请求时，它们已经被设置就绪。</p>

<h3 id="Origin">Origin</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段 Origin 指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。"><code>Origin</code></a> 首部字段表明预检请求或实际请求的源站。</p>

<pre class="notranslate">Origin: &lt;origin&gt;
</pre>

<p>origin 参数的值为源站 URI。它不包含任何路径信息，只是服务器名称。</p>

<div class="note notecard"><strong>Note:</strong> 有时候将该字段的值设置为空字符串是有用的，例如，当源站是一个 data URL 时。</div>

<p>注意，不管是否为跨域请求，ORIGIN 字段总是被发送。</p>

<h3 id="Access-Control-Request-Method">Access-Control-Request-Method</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Method" title="The compatibility table in this page is generated from structured data. If you&apos;d like to contribute to the data, please check out https://github.com/mdn/browser-compat-data and send us a pull request."><code>Access-Control-Request-Method</code></a> 首部字段用于预检请求。其作用是，将实际请求所使用的 HTTP 方法告诉服务器。</p>

<pre class="notranslate">Access-Control-Request-Method: &lt;method&gt;
</pre>

<p>相关示例见<a href="#Preflighted_requests">这里</a>。</p>

<h3 id="Access-Control-Request-Headers">Access-Control-Request-Headers</h3>

<p><a href="/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Headers" title="请求头  Access-Control-Request-Headers 出现于 preflight request （预检请求）中，用于通知服务器在真正的请求中会采用哪些请求头。"><code>Access-Control-Request-Headers</code></a> 首部字段用于预检请求。其作用是，将实际请求所携带的首部字段告诉服务器。</p>

<pre class="notranslate">Access-Control-Request-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*
</pre>

<p>相关示例见<a href="#">这里</a>。</p>

<h2 id="规范">规范</h2>

<table>
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a class="external" href="https://fetch.spec.whatwg.org/#cors-protocol" hreflang="en" lang="en">Fetch<br><small lang="zh-CN">CORS</small></a></td>
   <td><span class="spec-Living">Living Standard</span></td>
   <td>New definition; supplants CORS specification.</td>
  </tr>
  <tr>
   <td><a class="external" hreflang="en" lang="en">Unknown</a></td>
   <td><span class="spec-">Unknown</span></td>
   <td>Initial definition.</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<p class="hidden">The compatibility table in this page is generated from structured data. If you&apos;d like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>

<div class="bc-data" id="bcd:http.headers.Access-Control-Allow-Origin"></div>

<h3 id="注">注</h3>

<ul>
 <li>IE 10 提供了对规范的完整支持，但在较早版本（8 和 9）中，CORS 机制是借由 XDomainRequest 对象完成的。</li>
 <li>Firefox 3.5 引入了对 XMLHttpRequests 和 Web 字体的跨域支持（但最初的实现并不完整，这在后续版本中得到完善）；Firefox 7 引入了对 WebGL 贴图的跨域支持；Firefox 9 引入了对 drawImage 的跨域支持。</li>
</ul>

<h2 id="参见">参见</h2>

<ul>
 <li><a href="http://arunranga.com/examples/access-control/">Code Samples Showing <code>XMLHttpRequest</code> and Cross-Origin Resource Sharing</a></li>
 <li><a href="/en-US/docs/Web/HTTP/Server-Side_Access_Control">Cross-Origin Resource Sharing From a Server-Side Perspective (PHP, etc.)</a></li>
 <li><a href="http://www.w3.org/TR/cors/">Cross-Origin Resource Sharing specification</a></li>
 <li><a href="/zh-CN/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a></li>
 <li><a href="/en-US/docs/Web/API/Fetch_API">Fetch API</a></li>
 <li><a href="http://www.kendoui.com/blogs/teamblog/posts/11-10-03/using_cors_with_all_modern_browsers.aspx">Using CORS with All (Modern) Browsers</a></li>
 <li><a href="http://www.html5rocks.com/en/tutorials/cors/">Using CORS - HTML5 Rocks</a></li>
</ul>
