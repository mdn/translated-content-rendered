---
title: AudioContext.createScriptProcessor()
slug: Web/API/AudioContext/createScriptProcessor
translation_of: Web/API/BaseAudioContext/createScriptProcessor
---
<section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/Web_Audio_API">Web Audio API</a></strong></li><li><strong><a href="/zh-CN/docs/Web/API/AudioContext"><code>AudioContext</code></a></strong></li><li class="toggle"><details open><summary>Constructor</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/AudioContext"><code>AudioContext()</code></a></li></ol></details></li><li class="toggle"><details open><summary>属性</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/baseLatency"><code>baseLatency</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/outputLatency"><code>outputLatency</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/outputLatency$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>方法</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/baseLatency"><code>baseLatency</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/close"><code>close()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/API/AudioContext/createJavaScriptNode"><code>createJavaScriptNode()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createJavaScriptNode$translate" style="opacity: 0.5;">[我来译!]</a></s></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaElementSource"><code>createMediaElementSource()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamDestination"><code>createMediaStreamDestination()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamSource"><code>createMediaStreamSource()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamTrackSource"><code>createMediaStreamTrackSource()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamTrackSource$translate" style="opacity: 0.5;">[我来译!]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/API/AudioContext/createWaveTable"><code>createWaveTable()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createWaveTable$translate" style="opacity: 0.5;">[我来译!]</a></s></li><li><a href="/zh-CN/docs/Web/API/AudioContext/getOutputTimestamp"><code>getOutputTimestamp()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/getOutputTimestamp$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/outputLatency"><code>outputLatency</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/outputLatency$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/resume"><code>resume()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/suspend"><code>suspend()</code></a></li></ol></details></li><li class="toggle"><details open><summary>继承</summary><ol><li><a href="/zh-CN/docs/Web/API/EventTarget"><code>EventTarget</code></a></li></ol></details></li><li class="toggle"><details open><summary>Related pages for Web Audio API</summary><ol><li><a href="/zh-CN/docs/Web/API/AnalyserNode"><code>AnalyserNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioBuffer"><code>AudioBuffer</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioBufferSourceNode"><code>AudioBufferSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContextOptions"><code>AudioContextOptions</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioDestinationNode"><code>AudioDestinationNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioListener"><code>AudioListener</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioNode"><code>AudioNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioNodeOptions"><code>AudioNodeOptions</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioParam"><code>AudioParam</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioProcessingEvent"><code>AudioProcessingEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioScheduledSourceNode"><code>AudioScheduledSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorklet"><code>AudioWorklet</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletGlobalScope"><code>AudioWorkletGlobalScope</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletNode"><code>AudioWorkletNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletProcessor"><code>AudioWorkletProcessor</code></a></li><li><a href="/zh-CN/docs/Web/API/BaseAudioContext"><code>BaseAudioContext</code></a></li><li><a href="/zh-CN/docs/Web/API/BiquadFilterNode"><code>BiquadFilterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ChannelMergerNode"><code>ChannelMergerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ChannelSplitterNode"><code>ChannelSplitterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ConstantSourceNode"><code>ConstantSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ConvolverNode"><code>ConvolverNode</code></a></li><li><a href="/zh-CN/docs/Web/API/DelayNode"><code>DelayNode</code></a></li><li><a href="/zh-CN/docs/Web/API/DynamicsCompressorNode"><code>DynamicsCompressorNode</code></a></li><li><a href="/zh-CN/docs/Web/API/GainNode"><code>GainNode</code></a></li><li><a href="/zh-CN/docs/Web/API/IIRFilterNode"><code>IIRFilterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaElementAudioSourceNode"><code>MediaElementAudioSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaStreamAudioDestinationNode"><code>MediaStreamAudioDestinationNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode"><code>MediaStreamAudioSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/OfflineAudioCompletionEvent"><code>OfflineAudioCompletionEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/OfflineAudioContext"><code>OfflineAudioContext</code></a></li><li><a href="/zh-CN/docs/Web/API/OscillatorNode"><code>OscillatorNode</code></a></li><li><a href="/zh-CN/docs/Web/API/PannerNode"><code>PannerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/PeriodicWave"><code>PeriodicWave</code></a></li><li><a href="/zh-CN/docs/Web/API/StereoPannerNode"><code>StereoPannerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/WaveShaperNode"><code>WaveShaperNode</code></a></li></ol></details></li></ol></section>

<div>
<p><a href="/zh-CN/docs/Web/API/AudioContext"><code>AudioContext</code></a> 接口的<code>createScriptProcessor()</code> 方法创建一个<a href="/zh-CN/docs/Web/API/ScriptProcessorNode"><code>ScriptProcessorNode</code></a> 用于通过JavaScript直接处理音频.</p>
</div>

<h2 id="语法">语法</h2>

<pre class="brush: js">var audioCtx = new AudioContext();
myScriptProcessor = audioCtx.createScriptProcessor(<code>bufferSize</code>, <code>numberOfInputChannels</code>, <code>numberOfOutputChannels</code>);</pre>

<h3 id="Parameters" name="Parameters">参数</h3>

<dl>
 <dt><code>bufferSize</code></dt>
 <dd>缓冲区大小，以样本帧为单位。具体来讲，缓冲区大小必须是下面这些值当中的某一个: 256, 512, 1024, 2048, 4096, 8192, 16384. 如果不传，或者参数为0，则取当前环境最合适的缓冲区大小, 取值为2的幂次方的一个常数，在该node的整个生命周期中都不变.</dd>
 <dd>该取值控制着<code>audioprocess事件被分派的频率，以及每一次调用多少样本帧被处理</code>. 较低bufferSzie将导致一定的延迟。较高的bufferSzie就要注意避免音频的崩溃和故障。推荐作者不要给定具体的缓冲区大小，让系统自己选一个好的值来平衡延迟和音频质量。</dd>
 <dt><code>numberOfInputChannels</code></dt>
 <dd>值为整数，用于指定输入node的声道的数量，默认值是2，最高能取32.</dd>
 <dt><code>numberOfOutputChannels</code></dt>
 <dd>值为整数，用于指定输出node的声道的数量，默认值是2，最高能取32.</dd>
</dl>

<div class="warning notecard">
<p><span style="font-size: 14px;"><strong>重要</strong></span>: Webkit (version 31)要求调用这个方法的时候必须传入一个有效的bufferSize .</p>
</div>

<div class="note">
<p><span style="font-size: 14px;"><strong>注意</strong></span>: <code>numberOfInputChannels<font face="Open Sans, Arial, sans-serif">和</font></code><code>numberOfOutputChannels的值不能同时为0，二者同时为0是无效的</code></p>
</div>

<h3 id="Description" name="Description">返回</h3>

<p>A <a href="/zh-CN/docs/Web/API/ScriptProcessorNode"><code>ScriptProcessorNode</code></a>.</p>

<h2 id="示例">示例</h2>

<p><code><font face="Open Sans, Arial, sans-serif">下面的例子展示了一个</font>ScriptProcessorNode的基本用法，数据源取自</code> <a href="/zh-CN/docs/Web/API/AudioContext/decodeAudioData"><code>AudioContext.decodeAudioData</code></a>, 给每一个音频样本加一点白噪声，然后通过<a href="/zh-CN/docs/Web/API/AudioDestinationNode"><code>AudioDestinationNode</code></a>播放(其实这个就是系统的扬声器)。 对于每一个声道和样本帧，在把结果当成输出样本之前，<code>scriptNode.onaudioprocess方法<font face="Open Sans, Arial, sans-serif">关联</font></code><code>audioProcessingEvent</code> ，并用它来遍历每输入流的每一个声道，和每一个声道中的每一个样本，并添加一点白噪声。</p>

<div class="note">
<p><span style="font-size: 14px;"><strong>注意</strong></span>: 完整的示例参照 <a href="https://mdn.github.io/webaudio-examples/script-processor-node/">script-processor-node</a> github (查看源码 <a href="https://github.com/mdn/webaudio-examples/blob/master/script-processor-node/index.html">source code</a>.)</p>
</div>

<pre class="brush: js">var myScript = document.querySelector(&apos;script&apos;);
var myPre = document.querySelector(&apos;pre&apos;);
var playButton = document.querySelector(&apos;button&apos;);

// Create AudioContext and buffer source
var audioCtx = new AudioContext();
source = audioCtx.createBufferSource();

// Create a ScriptProcessorNode with a bufferSize of 4096 and a single input and output channel
var scriptNode = audioCtx.createScriptProcessor(4096, 1, 1);
console.log(scriptNode.bufferSize);

// load in an audio track via XHR and decodeAudioData

function getData() {
  request = new XMLHttpRequest();
  request.open(&apos;GET&apos;, &apos;viper.ogg&apos;, true);
  request.responseType = &apos;arraybuffer&apos;;
  request.onload = function() {
    var audioData = request.response;

    audioCtx.decodeAudioData(audioData, function(buffer) {
    myBuffer = buffer;
    source.buffer = myBuffer;
  },
    function(e){&quot;Error with decoding audio data&quot; + e.err});
  }
  request.send();
}

// Give the node a function to process audio events
scriptNode.onaudioprocess = function(audioProcessingEvent) {
  // The input buffer is the song we loaded earlier
  var inputBuffer = audioProcessingEvent.inputBuffer;

  // The output buffer contains the samples that will be modified and played
  var outputBuffer = audioProcessingEvent.outputBuffer;

  // Loop through the output channels (in this case there is only one)
  for (var channel = 0; channel &lt; outputBuffer.numberOfChannels; channel++) {
    var inputData = inputBuffer.getChannelData(channel);
    var outputData = outputBuffer.getChannelData(channel);

    // Loop through the 4096 samples
    for (var sample = 0; sample &lt; inputBuffer.length; sample++) {
      // make output equal to the same as the input
      outputData[sample] = inputData[sample];

      // add noise to each output sample
      outputData[sample] += ((Math.random() * 2) - 1) * 0.2;
    }
  }
}

getData();

// wire up play button
playButton.onclick = function() {
  source.connect(scriptNode);
  scriptNode.connect(audioCtx.destination);
  source.start();
}

// When the buffer source stops playing, disconnect everything
source.onended = function() {
  source.disconnect(scriptNode);
  scriptNode.disconnect(audioCtx.destination);
}
</pre>

<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a class="external" href="https://webaudio.github.io/web-audio-api/#widl-AudioContext-createScriptProcessor-ScriptProcessorNode-unsigned-long-bufferSize-unsigned-long-numberOfInputChannels-unsigned-long-numberOfOutputChannels" hreflang="en" lang="en">Web Audio API<br><small lang="zh-CN">createScriptProcessor</small></a></td>
   <td><span class="spec-WD">Working Draft</span></td>
   <td></td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<div><div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/zh-CN/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Desktop</a></li>
        <li><a>Mobile</a></li>
    </ul>
</div></div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Chrome</th>
   <th>Edge</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari (WebKit)</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>10.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with &apos;webkit&apos; as this browser considers it experimental">webkit</a></span></td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><a href="/en-US/Firefox/Releases/25" title="Released on 2013-10-29.">25.0</a> (25.0) </td>
   <td><span style="color: #f00;">未实现</span></td>
   <td>15.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with &apos;webkit&apos; as this browser considers it experimental">webkit</a></span><br>
    22 (unprefixed)</td>
   <td>6.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with &apos;webkit&apos; as this browser considers it experimental">webkit</a></span></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Android</th>
   <th>Edge</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>Firefox OS</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
   <th>Chrome for Android</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td>26.0</td>
   <td>1.2</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>33.0</td>
  </tr>
 </tbody>
</table>
</div>

<h2 id="See_also">See also</h2>

<ul>
 <li><a href="/en-US/docs/Web_Audio_API/Using_Web_Audio_API">Using the Web Audio API</a></li>
</ul>
