---
title: Drag Operations
slug: Web/API/HTML_Drag_and_Drop_API/Drag_operations
translation_of: Web/API/HTML_Drag_and_Drop_API/Drag_operations
original_slug: Web/Guide/HTML/Drag_and_drop/Drag_operations
---
<section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API">HTML Drag and Drop API</a></strong></li><li class="toggle"><details open><summary>Руководства</summary><ol><li><a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop">File drag and drop</a> <a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop$translate" style="opacity: 0.5;">[Перевести]</a></li><li><a href="/ru/docs/Web/Guide/HTML/Drag_and_drop/Drag_operations">Drag Operations</a></li><li><a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/Multiple_items">Dragging and Dropping Multiple Items</a> <a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/Multiple_items$translate" style="opacity: 0.5;">[Перевести]</a></li><li><a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types">Recommended Drag Types</a> <a href="/ru/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types$translate" style="opacity: 0.5;">[Перевести]</a></li></ol></details></li><li class="toggle"><details open><summary>Интерфейсы</summary><ol><li><a href="/ru/docs/Web/API/DataTransfer"><code>DataTransfer</code></a></li><li><a href="/ru/docs/Web/API/DataTransferItem"><code>DataTransferItem</code></a></li><li><a href="/ru/docs/Web/API/DataTransferItemList"><code>DataTransferItemList</code></a></li><li><a href="/ru/docs/Web/API/DragEvent"><code>DragEvent</code></a></li></ol></details></li><li class="toggle"><details open><summary>События</summary><ol><li><a href="/ru/docs/Web/API/HTMLElement/drag_event"><code>HTMLElement</code>: <code>drag</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragend_event"><code>HTMLElement</code>: <code>dragend</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragenter_event"><code>HTMLElement</code>: <code>dragenter</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragexit_event"><code>HTMLElement</code>: <code>dragexit</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragleave_event"><code>HTMLElement</code>: <code>dragleave</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragover_event"><code>HTMLElement</code>: <code>dragover</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/dragstart_event"><code>HTMLElement</code>: <code>dragstart</code></a></li><li><a href="/ru/docs/Web/API/HTMLElement/drop_event"><code>HTMLElement</code>: <code>drop</code></a></li></ol></details></li></ol></section>

<p>Ниже описаны шаги, которые происходят при drag and drop операции.</p>

<p class="note">Drag операции описываются в документе, используя <a href="/ru/docs/Web/API/DataTransfer" title="Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop. Он может хранить от одного до нескольких элементов данных, вне зависимости от их типа. Для получения доп. информации об операции drag and drop, см. Drag and Drop"><code>DataTransfer</code></a> интерфейс. Этот документ не использует не<a href="/ru/docs/Web/API/DataTransferItem" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>DataTransferItem</code></a> интерфейс, не<a href="/ru/docs/Web/API/DataTransferItemList" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>DataTransferItemList</code></a> интерфейс.</p>

<h2 id="draggableattribute" name="draggableattribute"><code>draggable</code> атрибуты</h2>

<p>На веб-странице, в некоторых случаях используется поведение drag (перетаскивания) по умолчанию. Включая выделенный текст, изображения и ссылки. Когда изображение иои ссылка переносятся, URL изображения или ссылки устанавливается в качестве данных drag и перетаскивание начинается. Для других элементов, они должны быть частью выделения для выполнения перетаскивания по умолчанию. Чтобы увидеть это в действии, выделите область веб-страницы, а затем нажмите и удерживайте кнопку мыши и перетащите выделение. Появится специфичный для ОС рендеринг выделенного фрагмента и будет следовать за указателем мыши при перетаскивании. Однако это поведение является только drag поведением по умолчанию, если нет слушателей, определяющих данные для перетаскивания.</p>

<p>В HTML, кроме поведения по умолчанию изображений, ссылок и выделенных областей, ноикакие другие элементы по умолчанию не переносятся.</p>

<p>Для перетаскивания других HTML-элементов, должны быть выполнены три пункта :</p>

<ol>
 <li>Установить <code><code><a href="/ru/docs/Web/HTML/Global_attributes#attr-draggable">draggable</a></code>=&quot;</code><code>true&quot;</code> на элемент, который вы хотите сделать перетаскиваемым.</li>
 <li>Добавить слушатель события <code><code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code></code>.</li>
 <li><a href="/en-US/docs/Web/API/DataTransfer/setData">Установить данные перетаскивания</a> в слушатель выше.</li>
</ol>

<p>Вот пример, который позволяет перетаскивать часть содержимого.</p>

<pre class="brush: html">&lt;p draggable=&quot;true&quot; ondragstart=&quot;event.dataTransfer.setData(&apos;text/plain&apos;, &apos;This text may be dragged&apos;)&quot;&gt;
  This text &lt;strong&gt;may&lt;/strong&gt; be dragged.
&lt;/p&gt;
</pre>

<p>Атрибут <code><code><a href="/ru/docs/Web/HTML/Global_attributes#attr-draggable">draggable</a></code></code> установлен в  <code>&quot;true&quot;</code>, т.о. этот элемент становится перетаскиваемым. Если этот атрибут был опущен или установлен в <code>&quot;false&quot;</code>, то элемент не может быть перенесен, и вместо этого будет выбран текст.</p>

<p>Атрибут <code><code><a href="/ru/docs/Web/HTML/Global_attributes#attr-draggable">draggable</a></code></code> может быть использован для любого элемента, включаяизображения и ссылки. Однако, для последних двух, значение по умолчанию - <code>true</code>, т.о. вы можете только использвать атрибут  <code><code><a href="/ru/docs/Web/HTML/Global_attributes#attr-draggable">draggable</a></code></code> со значением <code>false</code> для отключение перетаскивания этих элементов.</p>

<div class="note notecard">
<p><strong>Примечание:</strong> Когда элемент становится перетаскиваемыми, tтекст или другие элементы в нем больше не могут быть выбраны обычным способом, щелкая и перетаскивая мышью. Вместо этого пользователь должен удерживать клавишу <kbd>Alt</kbd>  чтобы выбрать текст с помощью мыши или клавиатуры.</p>
</div>

<h2 id="dragstart" name="dragstart">Начало операции перетаскивания</h2>

<p>В примере, слушатель добавлен для события <code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code> с использованием атрибута<code><a href="/ru/docs/Web/API/GlobalEventHandlers/ondragstart" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>ondragstart</code></a></code>.</p>

<pre class="brush: html">&lt;p draggable=&quot;true&quot; ondragstart=&quot;event.dataTransfer.setData(&apos;text/plain&apos;, &apos;This text may be dragged&apos;)&quot;&gt;
  This text &lt;strong&gt;may&lt;/strong&gt; be dragged.
&lt;/p&gt;
</pre>

<p>Когда пользователь начинает перетаскивание, запускается событиеdrag, the <code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code>.</p>

<p>В этом примере слушатель <code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code> добавлен к самому перемещаемом элементу. Однако, вы можете слушать более высокого предка, так как событие перетаскивание высплывает вверх как и большинство событий.</p>

<p>Внутри события <code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code>, вы можете указать <strong>drag данные</strong>, <strong>изображжение отклика</strong>, <strong>drag-эффекты</strong>, все это описано ниже. Однако, обязательны только <strong>drag данные</strong>. (Изображение и drag-эффекты по умолчанию, подходят в большинстве ситуаций)</p>

<h2 id="dragdata" name="dragdata">Drag-данные</h2>

<p>Все <a href="/ru/docs/Web/API/DragEvent" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>drag events</code></a> имеют свойство, называемое<a href="/ru/docs/Web/API/DragEvent/dataTransfer" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dataTransfer</code></a>, которое содержит drag-данные (<code>dataTransfer</code> это <a href="/ru/docs/Web/API/DataTransfer" title="Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop. Он может хранить от одного до нескольких элементов данных, вне зависимости от их типа. Для получения доп. информации об операции drag and drop, см. Drag and Drop"><code>DataTransfer</code></a> object).</p>

<p>Когда происходит перетаскивание, данные должны быть связаны с перетаскиванием, которое определяет, что перетаскивается. Например, при перетаскивании выделенного текста в текстовое поле данные, связанные с элементом данных перетаскивания, являются самим текстом. Аналогично, при перетаскивании ссылки на веб-странице элемент данных перетаскивания является URL-адресом ссылки.</p>

<p><a href="/ru/docs/Web/API/DataTransfer" title="Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop. Он может хранить от одного до нескольких элементов данных, вне зависимости от их типа. Для получения доп. информации об операции drag and drop, см. Drag and Drop"><code>drag data</code></a> содержит два параметра, <strong>тип</strong> (или формат) данных, и <strong>значение </strong>данных. Формат это строковый тип (такой как <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#text" title="text/plain">text/plain</a></code> текстовых данных), значение - строка текста. Когда начинается перетаскивание, вы добавляете данные, предоставляя тип и данные. Во время перетаскивания в слушателе события для событий <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> и <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> , вы используете типы данных перетаскиваемых данных, чтобы проверить, разрешено ли удаление. Например, цель drop, которая принимает ссылки, будет проверять тип <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#link" title="text/uri-list">text/uri-list</a></code>. В течение события drop, слушатель будет получать данные тащат и вставить его на место.</p>

<p>Свойство <a href="/ru/docs/Web/API/DataTransfer" title="Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop. Он может хранить от одного до нескольких элементов данных, вне зависимости от их типа. Для получения доп. информации об операции drag and drop, см. Drag and Drop"><code>drag data&apos;s</code></a> <a href="/ru/docs/Web/API/DataTransfer/types" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>types</code></a> возвращает список MIME-типов <a href="/ru/docs/Web/API/DOMString" title="DOMString - это UTF-16 String. Так как JavaScript уже использует такие строки, DOMString непосредственно соответствует String."><code>DOMString</code></a>, таких как <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#text" title="text/plain">text/plain</a></code> или <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#image" title="image/jpeg">image/jpeg</a></code>. Вы также можете создавать свои собственные типы. Большинство основные используемых типов описаны в  <a href="/en-US/docs/DragDrop/Recommended_Drag_Types" title="/en-US/docs/DragDrop/Recommended_Drag_Types">Recommended Drag Types</a>.</p>

<p>Перетаскивание может включать элементы данных нескольких различных типов. Это позволяет предоставлять данные в более специфических типах, часто пользовательских, но по предоставляет резервные данные для drop, которые не поддерживают более специфические типы. Как правило, наименее специфичным типом будут обычные текстовые данные, использующие тип <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#text" title="text/plain">text/plain</a></code>. Эти данные будут простым текстовым представлением.</p>

<p>Установка элементов drag-данных <a href="/ru/docs/Web/API/DragEvent/dataTransfer" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dataTransfer</code></a>, используя метод <a href="/ru/docs/Web/API/DataTransfer/setData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>setData()</code></a>. Требуется два аргумента: тип данных и значение данных. Например:</p>

<pre class="brush: js">event.dataTransfer.setData(&quot;text/plain&quot;, &quot;Text to drag&quot;);
</pre>

<p>Здесь, значение -  &quot;Text to drag&quot;, формат -  <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#text" title="text/plain">text/plain</a></code>.</p>

<p>Вы можете предусмотреть данные в нескольких форматах. Сделаем это, вызовем метод  <a href="/ru/docs/Web/API/DataTransfer/setData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>setData()</code></a> несколько раз с различными форматами. Вы должны вызывать его с форматами от большей специфичности к меньшей.</p>

<pre class="brush: js">const dt = event.dataTransfer;
dt.setData(&quot;application/x.bookmark&quot;, bookmarkString);
dt.setData(&quot;text/uri-list&quot;, &quot;https://www.mozilla.org&quot;);
dt.setData(&quot;text/plain&quot;, &quot;https://www.mozilla.org&quot;);
</pre>

<p>Добавлены данные трех различных форматов. Первый тип - <code>application/x.bookmark</code>, пользовательский тип.Другие приложения не поддерживают данный тип, но вы можете использовать пользовательский тип для перетаскивания между областями в одном приложениее или на одной странице.</p>

<p>Предоставляя данные и в других типах, мы также можем поддерживать перетаскивание в другие приложения в менее специфичных формах. Тип <code>application/x.bookmark</code> может предоставлять данные с  более подробной информацией для использования в приложении, в то время как другие типы могут включать только один URL-адрес или текстовую версию.</p>

<p>Обратите внимание, что и <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#link" title="text/uri-list">text/uri-list</a></code> и <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#text" title="text/plain">text/plain</a></code> cодержат одни и те же данные в этом примере.  Это часто бывает так, но это не обязательно.</p>

<p>Если вы попытаетесь добавить данные дважды с тем же форматом, новые данные заменят старые данные, но в той же позиции в списке типов, что и старые данные.</p>

<p>Вы можете очистить данные, используя метод <a href="/ru/docs/Web/API/DataTransfer/clearData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>clearData()</code></a>, который принимает один аргумент: тип данных для удаления.</p>

<pre class="brush: js">event.dataTransfer.clearData(&quot;text/uri-list&quot;);
</pre>

<p>Аргумент <code>type</code> в методе <a href="/ru/docs/Web/API/DataTransfer/clearData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>clearData()</code></a> опционален. Если <code>type</code> не указан, данные, связанные со всеми типами, удаляются. Если перетаскивание не содержит элементов данных перетаскивания или все элементы были впоследствии очищены, то перетаскивание не произойдет.</p>

<h2 id="dragfeedback" name="dragfeedback">Настройка изображения отклика drag</h2>

<p>Когда происходит перетаскивание, полупрозрачное изображение генерируется из цели перетаскивания (событие &quot;<code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code>&quot; элемента срабатывает), и следует за указателем пользователя во время перетаскивания. Это изображение создается автоматически, поэтому вам не нужно создавать его самостоятельно. Однако вы можете использовать <a href="/ru/docs/Web/API/DataTransfer/setDragImage" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>setDragImage()</code></a> для задания пользовательского изображения отклика перетаскивания.</p>

<pre class="brush: js">event.dataTransfer.setDragImage(image, xOffset, yOffset);
</pre>

<p>Необходимы три аргумента. Первый - это ссылка на изображение. Эта ссылка обычно относится к элементу <code>&lt;img&gt;</code>, но также может относиться к элементу <code>&lt;canvas&gt;</code> или любому другому элементу. Изображение отклика будет генерироваться из того, как изображение выглядит на экране, для изображений они будут нарисованы в их первоначальном размере. Второй и третий аргументы метода <a href="/ru/docs/Web/API/DataTransfer/setDragImage" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>setDragImage()</code></a> - это смещения, в которых изображение должно появляться относительно указателя мыши.</p>

<p>Также можно использовать изображения и canvas, которых нет в документе. Этот метод полезен при рисовании пользовательских изображений перетаскивания с помощью элемента canvas, как показано в следующем примере:</p>

<pre class="brush: js">function dragWithCustomImage(event) {
  const canvas = document.createElement(&quot;canvas&quot;);
  canvas.width = canvas.height = 50;

  const ctx = canvas.getContext(&quot;2d&quot;);
  ctx.lineWidth = 4;
  ctx.moveTo(0, 0);
  ctx.lineTo(50, 50);
  ctx.moveTo(0, 50);
  ctx.lineTo(50, 0);
  ctx.stroke();

  const dt = event.dataTransfer;
  dt.setData(&apos;text/plain&apos;, &apos;Data to Drag&apos;);
  dt.setDragImage(canvas, 25, 25);
}
</pre>

<p>В этом примере мы делаем один canvas перетаскивания. Поскольку размер холста составляет 50×50 пикселей, мы используем смещение половины этого (25), чтобы изображение было центрировано на указателе мыши.</p>

<h2 id="drageffects" name="drageffects">Drag эффекты</h2>

<p>При перетаскивании можно выполнить несколько операций. Операция  <code>copy</code> используется для указания на то, что перетаскиваемые данные будут скопированы из текущего местоположения в место перетаскивания. Операция <code>move</code> используется для указания на то, что перетаскиваемые данные будут перемещены, а операция <code>link</code> используется для указания на то, что между исходным и удаляемым местоположениями будет создана некоторая форма связи или соединения.</p>

<p>Вы можете указать, какая из трех операций разрешена для источника перетаскивания, установив свойство <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a> в слушателе событий<code><code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code></code>.</p>

<pre class="brush: js">event.dataTransfer.effectAllowed = &quot;copy&quot;;
</pre>

<p>В этом примере разрешена только <strong>копия</strong>.</p>

<p>Вы можете комбинировать значения различными способами:</p>

<dl>
 <dt><code>none</code></dt>
 <dd>никакая операция не разрешена</dd>
 <dt><code>copy</code></dt>
 <dd>только <code>copy</code></dd>
 <dt><code>move</code></dt>
 <dd>только <code>move</code></dd>
 <dt><code>link</code></dt>
 <dd>только <code>link</code></dd>
 <dt><code>copyMove</code></dt>
 <dd>только <code>copy</code> или <code>move</code></dd>
 <dt><code>copyLink</code></dt>
 <dd>только <code>copy</code> или <code>link</code></dd>
 <dt><code>linkMove</code></dt>
 <dd>только <code>link</code> или <code>move</code></dd>
 <dt><code>all</code></dt>
 <dd>только <code>copy</code>, <code>move</code>, или <code>link</code></dd>
 <dt>uninitialized</dt>
 <dd>Значение по умолчанию <code>all</code>.</dd>
</dl>

<p>Обратите внимание, что эти значения должны использоваться так, как указано выше. Например, установка свойства <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a> на <code>copyMove</code> позволяет выполнять операцию копирования или перемещения, но не позволяет пользователю выполнять операцию связывания. Если вы не измените свойство <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a>,  то любая операция разрешена, как и со значением &apos;<code>all</code>&apos;. Поэтому вам не нужно настраивать это свойство, если вы не хотите исключить определенные типы.</p>

<p>Во время операции перетаскивания, слушатель для событий <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> или <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> может проверить свойство <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a> , какие операции разрешены. Связанное свойство,  <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a>, должно быть установлено в пределах одного из этих событий, чтобы указать, какая единственная операция должна быть выполнена. Допустимые значения для <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> - <code>none</code>, <code>copy</code>, <code>move</code>, или <code>link</code>. Комбинированные значения для этого свойства не используются.</p>

<p>С событиями <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> и <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code>, свойство <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> инициализируется в соответствии с запросом пользователя. Пользователь может изменить желаемый эффект, нажав клавиши-модификаторы. Хотя точные используемые клавиши различаются в зависимости от платформы, обычно клавиши  <kbd>Shift</kbd> и <kbd>Control</kbd> используются для переключения между копированием, перемещением и связыванием. Указатель мыши изменится, чтобы указать, какая операция требуется. Например, для <code>copy</code> курсор может появиться со знаком плюс рядом с ним.</p>

<p>Вы можете изменять свойство <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> во время событий <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> или <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code>, например, определенная drop-цель поддерживает только определенные операции. Вы можете изменить свойство <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a>, чтобы переопределить действие пользователя, и обеспечить выполнение специфичной  операции перетаскивания при ее наступлении. Обратите внимание, что этот эффект должен быть указан в списке свойств <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a>. В противном случае ему будет присвоено другое допустимое значение.</p>

<pre class="brush: js">event.dataTransfer.dropEffect = &quot;copy&quot;;
</pre>

<p>В этом примере выполняется эффект копирования.</p>

<p>Вы можете использовать значение <code>none</code>, чтобы указать, что в этом месте не допускается удаление, хотя в этом случае лучше не отменять событие.</p>

<p>В событиях <code><code><a href="/ru/docs/Web/Reference/Events/drop" title="/ru/docs/Web/Reference/Events/drop">drop</a></code></code> и <code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code>, yвы можете проверить свойства <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> для определения того, какой эффект был в конечном итоге выбран.  Если выбран эффект &quot;<code>move</code>&quot;,то исходные данные должны быть удалены из источника перетаскивания в событии<code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code>.</p>

<h2 id="droptargets" name="droptargets">Указание drop-целей</h2>

<p>Слушатель для событий <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> и <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> используются для указания допустимых drop-целей, то есть мест, где могут быть сброшены перетаскиваемые элементы. Большинство областей веб-страницы или приложения не являются допустимыми местами для сброса данных. Таким образом, обработка этих событий по умолчанию не допускает сброса перетаскиваемых данных.</p>

<p>Если вы хотите разрешить сброс переносимых данных, вы должны предотвратить обработку по умолчанию, отменив оба события <code>dragenter</code> и <code>dragover</code>.  Это можно сделать, либо вернув <code>false</code> из определенных атрибутом слушателя событий, либо вызвав метод <a href="/ru/docs/Web/API/Event/preventDefault" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>preventDefault()</code></a> событие. Последнее может быть более осуществимо в функции, определенной в отдельном скрипте.</p>

<pre class="brush: html">&lt;div ondragover=&quot;return false&quot;&gt;
&lt;div ondragover=&quot;event.preventDefault()&quot;&gt;
</pre>

<p>Вызывая метод <a href="/ru/docs/Web/API/Event/preventDefault" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>preventDefault()</code></a> во время обоих событий <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> и <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> укажите, что падение разрешено в этом месте. Однако обычно вы захотите вызвать метод  <a href="/ru/docs/Web/API/Event/preventDefault" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>preventDefault()</code></a> события только в определенных ситуациях (например, только при перетаскивании ссылки).</p>

<p>Для этого вызовите функцию, которая проверяет условие и отменяет событие только при его выполнении. Если условие не выполнено, не отменяйте событие, и сброс перетаскиваемых данных не произойдет, если пользователь отпустит кнопку мыши.</p>

<p>Наиболее распространенным является принятие или отклонение сброса в зависимости от типа данных перетаскивания при передаче данных — например, разрешение для изображений, ссылок или и того, и другого. Для этого вы можете проверить свойство <a href="/ru/docs/Web/API/DataTransfer/types" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>types</code></a> события <a href="/ru/docs/Web/API/DragEvent/dataTransfer" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dataTransfer</code></a> (свойство). Свойство <a href="/ru/docs/Web/API/DataTransfer/types" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>types</code></a> возвращает массив из строк, добавленных при начале перетаскивания, в порядке от наиболее значимого к наименее значимому.</p>

<pre class="brush: js">function doDragOver(event) {
  const isLink = event.dataTransfer.types.includes(&quot;text/uri-list&quot;);
  if (isLink) {
    event.preventDefault();
  }
}</pre>

<p>В этом примере мы используем метод <code>includes</code>  чтобы проверить, присутствует ли тип <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#link" title="text/uri-list">text/uri-list</a></code> в списке типов. Если это так, мы отменим событие, так что сброс становится разрешен. Если перетаскиваемые данные не содержат ссылки, событие не будет отменено, и сброс не может произойти в этом месте.</p>

<p>Вы также можете установить либо свойство <a href="/ru/docs/Web/API/DataTransfer/effectAllowed" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>effectAllowed</code></a>, либо свойство<a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a>, либо оба одновременно, если вы хотите указать более конкретные сведения о типе операции, которая будет выполнена. Естественно, изменение любого свойства не будет иметь никакого эффекта, если вы не отмените событие.</p>

<h2 id="dropfeedback" name="dropfeedback">Drop Feedback</h2>

<p>There are several ways in which you can indicate to the user that a drop is allowed at a certain location. The mouse pointer will update as necessary depending on the value of the <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> property.</p>

<p>Although the exact appearance depends on the user&apos;s platform, typically a plus sign icon will appear for a &apos;<code>copy</code>&apos; for example, and a &apos;cannot drop here&apos; icon will appear when a drop is not allowed. This mouse pointer feedback is sufficient in many cases.</p>

<p>However, you can also update the user interface with an insertion point or highlight as needed. For simple highlighting, you can use the <code>:-moz-drag-over</code> CSS pseudoclass on a drop target.</p>

<pre class="brush: css">.droparea:-moz-drag-over {
  outline: 1px solid black;
}
</pre>

<p>In this example, the element with the class <code>droparea</code> will receive a 1 pixel black outline while it is a valid drop target, that is, if the <a href="/ru/docs/Web/API/Event/preventDefault" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>preventDefault()</code></a> method was called during the <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> event.</p>

<div class="note notecard">
<p><strong>Note:</strong> You must cancel the <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> event for this pseudoclass to apply, as this state is not checked for the <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> event.</p>
</div>

<p>For more complex visual effects, you can also perform other operations during the <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> event. For example, by inserting an element at the location where the drop will occur. This might be an insertion marker, or an element that represents the dragged element in its new location. To do this, you could create an <a href="/en-US/docs/XUL/image" title="image">image</a> or <a href="/en-US/docs/XUL/separator" title="separator">separator</a> element and simply insert it into the document during the <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> event.</p>

<p>The <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> event will fire at the element the mouse is pointing at. Naturally, you may need to move the insertion marker around a <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> event as well. You can use the event&apos;s <a href="/ru/docs/Web/API/MouseEvent/clientX" title="MouseEvent.clientX свойство доступное только для чтения. Это свойство является горизонтальной координатой в пределах клиентской области приложения, на которой произошло событие (в отличие от координат внутри страницы). Для примера, нажатие в верхнем левом углу клиентской области будет всегда приводить к событию со значением свойства clientX равным 0, независимо от того, прокручена страницы по горизонтали или нет."><code>clientX</code></a> and <a href="/ru/docs/Web/API/MouseEvent/clientY" title="MouseEvent.clientY свойство доступное только для чтения. Это свойство является вертикальной координатой в пределах клиентской области приложения, на которой произошло событие (в отличие от координат внутри страницы). Для примера, нажатие в верхнем левом углу клиентской области будет всегда приводить к событию со значением свойства clientY равным 0, независимо от того, прокручена страницы по вертикали или нет."><code>clientY</code></a> properties as with other mouse events to determine the location of the mouse pointer.</p>

<p>Finally, the <code><code><a href="/ru/docs/Web/Reference/Events/dragleave" title="/ru/docs/Web/Reference/Events/dragleave">dragleave</a></code></code> event will fire at an element when the drag leaves the element. This is the time when you should remove any insertion markers or highlighting. You do not need to cancel this event. Any highlighting or other visual effects specified using the <code>:-moz-drag-over</code> pseudoclass will be removed automatically. The <code><code><a href="/ru/docs/Web/Reference/Events/dragleave" title="/ru/docs/Web/Reference/Events/dragleave">dragleave</a></code></code> event will always fire, even if the drag is cancelled, so you can always ensure that any insertion point cleanup can be done during this event.</p>

<h2 id="drop" name="drop">Performing a Drop</h2>

<p>When the user releases the mouse, the drag and drop operation ends.</p>

<p>If the mouse is released over an element that is a valid drop target, that is, one that cancelled the last <code><code><a href="/ru/docs/Web/Reference/Events/dragenter" title="/ru/docs/Web/Reference/Events/dragenter">dragenter</a></code></code> or <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> event, then the drop will be successful, and a <code><code><a href="/ru/docs/Web/Reference/Events/drop" title="/ru/docs/Web/Reference/Events/drop">drop</a></code></code> event will fire at the target. Otherwise, the drag operation is cancelled, and no <code><code><a href="/ru/docs/Web/Reference/Events/drop" title="/ru/docs/Web/Reference/Events/drop">drop</a></code></code> event is fired.</p>

<p>During the <code><code><a href="/ru/docs/Web/Reference/Events/drop" title="/ru/docs/Web/Reference/Events/drop">drop</a></code></code> event, you should retrieve that data that was dropped from the event and insert it at the drop location. You can use the <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> property to determine which drag operation was desired.</p>

<p>As with all drag-related events, the event&apos;s <code><a href="/ru/docs/Web/API/DataTransfer" title="Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop. Он может хранить от одного до нескольких элементов данных, вне зависимости от их типа. Для получения доп. информации об операции drag and drop, см. Drag and Drop"><code>dataTransfer</code></a></code> property will hold the data that is being dragged. The <a href="/ru/docs/Web/API/DataTransfer/getData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>getData()</code></a> method may be used to retrieve the data again.</p>

<pre class="brush: js">function onDrop(event) {
  const data = event.dataTransfer.getData(&quot;text/plain&quot;);
  event.target.textContent = data;
  event.preventDefault();
}
</pre>

<p>The <a href="/ru/docs/Web/API/DataTransfer/getData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>getData()</code></a> method takes one argument, the type of data to retrieve. It will return the string value that was set when <a href="/ru/docs/Web/API/DataTransfer/setData" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>setData()</code></a> was called at the beginning of the drag operation. An empty string will be returned if data of that type does not exist. (Naturally, though, you would likely know that the right type of data was available, as it was previously checked during a <code><code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code></code> event.)</p>

<p>In the example here, once the data has been retrieved, we insert the string as the textual content of the target. This has the effect of inserting the dragged text where it was dropped, assuming that the drop target is an area of text such as a <code>p</code> or <code>div</code> element.</p>

<p>In a web page, you should call the <a href="/ru/docs/Web/API/Event/preventDefault" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>preventDefault()</code></a> method of the event if you have accepted the drop, so that the browser&apos;s default handling is not triggered by the dropped data as well. For example, when a link is dragged to a web page, Firefox will open the link. By cancelling the event, this behavior will be prevented.</p>

<p>You can retrieve other types of data as well. If the data is a link, it should have the type <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#link" title="text/uri-list">text/uri-list</a></code>. You could then insert a link into the content.</p>

<pre class="brush: js">function doDrop(event) {
  const lines = event.dataTransfer.getData(&quot;text/uri-list&quot;).split(&quot;\n&quot;);
  lines.filter(line =&gt; !line.startsWith(&quot;#&quot;))
    .forEach(line =&gt; {
      const link = document.createElement(&quot;a&quot;);
      link.href = line;
      link.textContent = line;
      event.target.appendChild(link);
    })
  event.preventDefault();
}
</pre>

<p>This example inserts a link from the dragged data. As the name implies, the <code><a href="/en-US/docs/DragDrop/Recommended_Drag_Types#link" title="text/uri-list">text/uri-list</a></code> type actually may contain a list of URLs, each on a separate line. The above code uses <code><a href="/en-US/docs/JavaScript/Reference/Global_Objects/String/split" title="split">split</a></code> to break the string into lines, then iterates over the list of lines, and inserts each as a link into the document. (Note also that links starting with a number sign (<code>#</code>) are skipped, as these are comments.)</p>

<p>For simple cases, you can use the special type <code>URL</code> just to retrieve the first valid URL in the list. For example:</p>

<pre class="brush: js">const link = event.dataTransfer.getData(&quot;URL&quot;);
</pre>

<p>This eliminates the need to check for comments or iterate through lines yourself. However, it is limited to only the first URL in the list.</p>

<p>The <code>URL</code> type is a special type. It is used only as a shorthand, and it does not appear within the list of types specified in the <a href="/ru/docs/Web/API/DataTransfer/types" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>types</code></a> property.</p>

<p>Sometimes you may support some different formats, and you want to retrieve the data that is most specific that is supported. In the following example, three formats are supported by a drop target.</p>

<p>The following example returns the data associated with the best-supported format:</p>

<pre class="brush: js">function doDrop(event) {
  const supportedTypes = [&quot;application/x-moz-file&quot;, &quot;text/uri-list&quot;, &quot;text/plain&quot;];
  const types = event.dataTransfer.types.filter(type =&gt; supportedTypes.includes(type));
  if (types.length) {
    const data = event.dataTransfer.getData(types[0]);
  }
  event.preventDefault();
}
</pre>

<h2 id="dragend" name="dragend">Окончание перетаскивания</h2>

<p>Как только перетаскивание завершено, событие <code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code> запускается в источнике перетаскивания (тот же элемент, который получил событие <code><code><a href="/ru/docs/Web/Reference/Events/dragstart" title="/ru/docs/Web/Reference/Events/dragstart">dragstart</a></code></code>). Это событие сработает, если перетаскивание было успешным<sup>[1]</sup> или если оно было отменено. Однако вы можете использовать свойство <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> для определения, какая операция удаления произошла.</p>

<p>Если свойство <a href="/ru/docs/Web/API/DataTransfer/dropEffect" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>dropEffect</code></a> имеет значение <code>none</code> во время события <code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code>, то перетаскивание было отменено. В противном случае эффект указывает, какая операция была выполнена. Источник может использовать эту информацию после операции перемещения для удаления перетаскиваемого элемента из старого расположения. Свойство <a href="/ru/docs/Web/API/DataTransfer/mozUserCancelled" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>mozUserCancelled</code></a> будет присвоено значение <code>true</code>, если пользователь отменил перетаскивание (нажав <kbd>Escape</kbd>), и <code>false</code> если перетаскивание было отменено по другим причинам, таким как недопустимая цель перетаскивания, или если оно было успешным.</p>

<p>Сброс может произойти внутри того же окна или над другим приложением. Событие<code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code>будет срабатывать всегда, независимо от этого. Свойство события <a href="/ru/docs/Web/API/MouseEvent/screenX" title="screenX - read-only свойство интерфейса события MouseEvent, соответствующее горизонтальной координате (смещению) указателя мыши в глобальных (экранных) координатах."><code>screenX</code></a> и <a href="/ru/docs/Web/API/MouseEvent/screenY" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>screenY</code></a> будут установлены в координаты экрана, где произошел сброс.</p>

<p>Когда событие <code><code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code></code> завершило распространение, операция перетаскивания завершена.</p>

<p>[1]: В Gecko, <code><a href="/ru/docs/Web/Reference/Events/dragend" title="/ru/docs/Web/Reference/Events/dragend">dragend</a></code> не отправляется, если исходный узел движется или удаляется во время перетаскивания (например, при сбрасывании или <code><a href="/ru/docs/Web/Reference/Events/dragover" title="/ru/docs/Web/Reference/Events/dragover">dragover</a></code>). <a class="external" href="https://bugzilla.mozilla.org/show_bug.cgi?id=460801" title="New D&amp;D API: dragend is not dispatched if the source node was moved or removed during the drag session">Bug 460801</a></p>

<h2 id="See_also" name="See_also">Смотрите также</h2>

<ul>
 <li><a class="internal" href="/Web/API/HTML_Drag_and_Drop_API">HTML Drag and Drop API (Overview)</a></li>
 <li><a class="internal" href="/Web/Guide/HTML/Dragging_and_Dropping_Multiple_Items">Dragging and Dropping Multiple Items</a></li>
 <li><a class="internal" href="/Web/Guide/HTML/Recommended_Drag_Types">Recommended Drag Types</a></li>
 <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#dnd">HTML5 Living Standard: Drag and Drop</a></li>
</ul>
