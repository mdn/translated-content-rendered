---
title: Платформа и управление
slug: Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Платформа_и_управление
translation_of: Games/Tutorials/2D_breakout_game_Phaser/Player_paddle_and_controls
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li class="toggle">
        <details>
            <summary>Introduction</summary>
            <ol>
              <li><a href="/ru/docs/Games/Introduction">Introduction</a></li>
              <li><a href="/ru/docs/Games/Anatomy">Anatomy</a></li>
              <li><a href="/ru/docs/Games/Examples">Examples</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>APIs for game development</summary>
            <ol>
              <li><a href="/ru/docs/Web/API/Canvas_API">Canvas</a></li>
              <li><a href="/ru/docs/Web/CSS">CSS</a></li>
              <li><a href="/ru/docs/Web/Apps/Fundamentals/User_notifications/Full_screen_api">Full screen</a></li>
              <li><a href="/ru/docs/Web/API/Gamepad_API">Gamepad</a></li>
              <li><a href="/ru/docs/Web/API/IndexedDB_API">IndexedDB</a></li>
              <li><a href="/ru/docs/Web/JavaScript">JavaScript</a></li>
              <li><a href="/ru/docs/Web/API/Pointer_Lock_API">Pointer Lock</a></li>
              <li><a href="/ru/docs/Web/SVG">SVG</a></li>
              <li><a href="/ru/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">Typed Arrays</a></li>
              <li><a href="/ru/docs/Web/API/Web_Audio_API">Web Audio</a></li>
              <li><a href="/ru/docs/Web/API/WebGL_API">WebGL</a></li>
              <li><a href="/ru/docs/Web/API/WebRTC_API">WebRTC</a></li>
              <li><a href="/ru/docs/Web/API/WebSockets_API">WebSockets</a></li>
              <li><a href="/ru/docs/Web/API/WebVR_API">WebVR</a></li>
              <li><a href="/ru/docs/Web/API/Web_Workers_API">Web Workers</a></li>
              <li><a href="/ru/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Techniques</summary>
            <ol>
              <li><a href="/ru/docs/Games/Techniques/Async_scripts">Using async scripts for asm.js</a></li>
              <li><a href="/ru/docs/Web/Apps/Developing/Optimizing_startup_performance">Optimizing startup performance</a></li>
              <li><a href="/ru/docs/Games/Techniques/WebRTC_data_channels">Using WebRTC peer-to-peer data channels</a></li>
              <li><a href="/ru/docs/Games/Techniques/Efficient_animation_for_web_games">Efficient animation for web games</a></li>
              <li><a href="/ru/docs/Games/Techniques/Audio_for_Web_Games">Audio for Web Games</a></li>
              <li><a href="/ru/docs/Games/Techniques/2D_collision_detection">2D collision detection</a></li>
              <li><a href="/ru/docs/Games/Techniques/Tilemaps">Tiles and tilemaps overview</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>3D games on the Web</summary>
            <ol>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web">3D games on the Web overview</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/Basic_theory">Explaining basic 3D theory</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_A-Frame">Building up a basic demo with A-Frame</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Babylon.js">Building up a basic demo with Babylon.js</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_PlayCanvas">Building up a basic demo with PlayCanvas</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Three.js">Building up a basic demo with Three.js</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_on_the_web/WebVR">WebVR</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_collision_detection">3D collision detection</a></li>
              <li><a href="/ru/docs/Games/Techniques/3D_collision_detection/Bounding_volume_collision_detection_with_THREE.js">Bounding volume collision detection with THREE.js</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Implementing game control mechanisms</summary>
            <ol>
              <li><a href="/ru/docs/Games/Techniques/Control_mechanisms">Control mechanisms</a></li>
              <li><a href="/ru/docs/Games/Techniques/Control_mechanisms/Mobile_touch">Mobile touch</a></li>
              <li><a href="/ru/docs/Games/Techniques/Control_mechanisms/Desktop_with_mouse_and_keyboard">Desktop with mouse and keyboard</a></li>
              <li><a href="/ru/docs/Games/Techniques/Control_mechanisms/Desktop_with_gamepad">Desktop with gamepad</a></li>
              <li><a href="/ru/docs/Games/Techniques/Control_mechanisms/Other">Other</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Tutorials</summary>
            <ol>
              <li><a href="/ru/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript">2D breakout game using pure JavaScript</a></li>
              <li><a href="/ru/docs/Games/Tutorials/2D_breakout_game_Phaser">2D breakout game using Phaser</a></li>
              <li><a href="/ru/docs/Games/Tutorials/HTML5_Gamedev_Phaser_Device_Orientation">2D maze_game with device orientation</a></li>
              <li><a href="https://mozdevs.github.io/html5-games-workshop/en/guides/platformer/start-here/">2D platform game using Phaser</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Publishing games</summary>
            <ol>
              <li><a href="/ru/docs/Games/Publishing_games">Publishing games overview</a></li>
              <li><a href="/ru/docs/Games/Publishing_games/Game_distribution">Game distribution</a></li>
              <li><a href="/ru/docs/Games/Publishing_games/Game_promotion">Game promotion</a></li>
              <li><a href="/ru/docs/Games/Publishing_games/Game_monetization">Game monetization</a></li>
            </ol>
        </details>
    </li>
  </ol>
</section></div>

<div></div>

<div class="prevnext" style="text-align: right;">
    <p><a href="/ru/docs/Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Bounce_off_the_walls" style="float: left;" class="button">« Предыдущая статья</a><a href="/ru/docs/Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Game_over" class="button">Следующая статья  »</a></p>
</div>

<div class="summary">
<p>Это <strong>7 </strong>из 16 уроков <a href="https://developer.mozilla.org/ru/docs/Games/Tutorials/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_2D_Breakout_%D0%B8%D0%B3%D1%80%D1%8B_%D0%BD%D0%B0_Phaser">руководства разработки игры с помощью Phaser</a>. Исходный код этого урока вы можете найти здесь: <a href="https://github.com/end3r/Gamedev-Phaser-Content-Kit/blob/gh-pages/demos/lesson07.html">Gamedev-Phaser-Content-Kit/demos/lesson07.html</a>.</p>
</div>

<p><span class="seoSummary">Теперь, когда мы научили мячик двигаться и отскакивать от стен, давайте добавим немного геймплея. В этой главе мы создадим платформу-ракетку, которой будем отбивать наш мячик.</span></p>

<h2 id="Рисуем_платформу">Рисуем платформу</h2>

<p>С точки зрения фреймворка, платформа и мячик не сильно различаются - нам так же понадобится переменная для платформы, спрайт и немного магии.</p>

<h3 id="Создаем_платформу">Создаем платформу</h3>

<p>Сначала, добавим переменную <code>paddle</code>, сразу после переменной <code>ball</code>:</p>

<pre class="brush: js">var paddle;
</pre>

<p>После этого, в функции <code>preload</code>, загрузим изображение <code>paddle</code> при помощи ещё одного вызова функции <code>load.image()</code>:</p>

<pre class="brush: js">function preload() {
    // ...
    game.load.image(&apos;ball&apos;, &apos;img/ball.png&apos;);
    game.load.image(&apos;paddle&apos;, &apos;img/paddle.png&apos;);
}
</pre>

<h3 id="Добавляем_графику_для_платформы">Добавляем графику для платформы</h3>

<p>Чуть не забыли, на этом этапе нам надо скачать <a href="https://github.com/end3r/Gamedev-Phaser-Content-Kit/blob/gh-pages/demos/img/paddle.png">изображение платформы с Github</a> в папку <code>/img</code>.</p>

<h3 id="Рисуем_платформу_с_физикой">Рисуем платформу с физикой</h3>

<p>Далее, мы инициализируем спрайт нашей платформы при помощи функции <code>add.sprite()</code> — добавьте следующую строку кода в самый конец функции <code>create()</code>:</p>

<pre class="brush: js">paddle = game.add.sprite(game.world.width*0.5, game.world.height-5, &apos;paddle&apos;);
</pre>

<p>Мы можем использовать <code>world.width</code> и <code>world.height</code> для позиционирования платформы в том месте, где мы хотим: <code>game.world.width*0.5</code> расположит платформу прямо по середине экрана. В данном случае, нам повезло, что наш игровой мир совпадает с <code>&lt;canvas&gt;</code>, однако, в других играх мир может быть гараздо больше экрана. </p>

<p>Как вы могли заметить, перезагрузив, на данном этапе, страницу <code>index.html</code>, платформа находится не совсем по середине экрана. Почему? Всё дело в том, что, по умолчанию, точка, из которой начинается позиционирование объекта (якорь), находится в левом верхнем углу. Но мы можем это изменить и переместить якорь в середину платформы по ширине и в самый низ повысоте, чтобы проще было позиционировать платформу, относительно нижней грани экрана. Добавьте следующую строку кода:</p>

<pre class="brush: js">paddle.anchor.set(0.5,1);
</pre>

<p>Платформу расположили там, где и хотели. Теперь, чтобы платформа могла взаимодействовать с мячиком, добавим ей физику. Добавьте следующую строку кода в самый низ функции <code>create()</code>:</p>

<pre class="brush: js">game.physics.enable(paddle, Phaser.Physics.ARCADE);
</pre>

<p>Вот и настало время для магии - фреймворк сам позаботится о проверке столкновений (коллизий) в каждом кадре. Для того, чтобы включить проверку коллизий между платформой и мячиком, вызовите функцию <code>collide()</code> в функции <code>update()</code> как показано ниже:</p>

<pre class="brush: js">function update() {
    game.physics.arcade.collide(ball, paddle);
}
</pre>

<p>В качестве аргументов, мы передаём два объекта, между которыми проверяются коллизии — в нашем случае, мячик и платформа. Вроде, сработало, но не совсем так, как мы ожидали — когда мячик сталкивается с платформой, последняя падает за пределы экрана! А мы, всего лишь, хотим, чтобы мячик отскакивал от платформы, а платформа, при этом, оставалась на месте. Мы можем использовать свойство <code>immovable</code>, для того, чтобы платформа не двигалась, когда мячик бьётся об неё. Для этого добавьте следующую строку кода в конец функции <code>create()</code>:</p>

<pre class="brush: js">paddle.body.immovable = true;
</pre>

<p>Вот! Теперь всё работает, как надо.</p>

<h2 id="Управляем_платформой">Управляем платформой</h2>

<p>Следующая проблема заключается в том, что мы не можем двигать платформу. Чтобы сделать это мы можем воспользоваться вводом <code>input</code> (мышь или сенсорный экран, в зависимости от платформы) и расположить нашу плаформу в месте расположения курсора. Добавьте следующую строку кода в функцию <code>update()</code>, как показано ниже:</p>

<pre class="brush: js">function update() {
    game.physics.arcade.collide(ball, paddle);
    paddle.x = game.input.x;
}
</pre>

<p>Теперь, каждый кадр координата <code>x</code> платформы будет соответствовать координате <code>x</code> курсора. Однако, при старте игры, положение нашей платформы не по центру экрана, из-за того, что положение курсора не определено. Чтобы это исправить, давайте добавим платформе координату <code>x</code> по умолчанию, на случаей, если положение курсора не определено. Обновите предыдущую строку кода:</p>

<pre class="brush: js">paddle.x = game.input.x || game.world.width*0.5;
</pre>

<p>Если вы этого ещё не сделали, то обновите страницу <code>index.html</code> и попробуйте то, что у нас получилось!</p>

<h2 id="Расположение_мячика">Расположение мячика</h2>

<p>Теперь давайте разместим мячик на платформе. Так же, как и платформу, расположим мячик по середине экрана по горизонтали, с небольшим отступом от нижней грани экрана по вертикали. Для этого переместим якорь мячика в его середину. Найдите строку <code>ball <span class="keyword operator">=</span> game.add.</code><span class="call function"><code>sprite( ... )</code> и заметите её на следующие две:</span></p>

<pre class="brush: js">ball = game.add.sprite(game.world.width*0.5, game.world.height-25, &apos;ball&apos;);
ball.anchor.set(0.5);</pre>

<p>Скорость оставим такую же, но изменим направление по оси <code>y</code>, изменив второй параметр со 150 на -150, и теперь мяч будет двигаться вверх. Найдите строку <code>ball.body.velocity.set( ... )</code> и измените её, как показано ниже:</p>

<pre class="brush: js">ball.body.velocity.set(150, -150);
</pre>

<p>Теперь мячик появляется по середине платформы и двигается вверх.</p>

<h2 id="Сравните_свой_код">Сравните свой код</h2>

<p>Вы можете проверить код из этого урока и поиграть с ним, чтобы лучше понять, как он работает:</p>

<p><iframe frameborder="0" height="400" src="https://jsfiddle.net/end3r/ogqza0ye/embedded/" width="100%"></iframe></p>

<h2 id="Следующий_шаг">Следующий шаг</h2>

<p>Мы можем управлять платформой и сделали так, чтобы мячик отскакивал от неё. Но какой от этого толк, если мячик отскакивает и от нижней грани экрана? В следующей главе мы добавим <a href="https://developer.mozilla.org/ru/docs/Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Game_over">логику проигрыша и экран &quot;Game over&quot;</a>.</p>

<div class="prevnext" style="text-align: right;">
    <p><a href="/ru/docs/Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Bounce_off_the_walls" style="float: left;" class="button">« Предыдущая статья</a><a href="/ru/docs/Games/Tutorials/Создание_2D_Breakout_игры_на_Phaser/Game_over" class="button">Следующая статья  »</a></p>
</div>
