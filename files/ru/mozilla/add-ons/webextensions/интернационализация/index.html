---
title: Интернационализация
slug: Mozilla/Add-ons/WebExtensions/Интернационализация
translation_of: Mozilla/Add-ons/WebExtensions/Internationalization
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions"><strong>Browser extensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Getting started</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">What are extensions?</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Your first extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Your second extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomy of an extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Examples">Example extensions</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/What_next_">What next?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">Using the JavaScript APIs</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Content scripts</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Match patterns</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Working with files</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalization</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices">Security best practices</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Content Security Policy</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Native messaging</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>User interface</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface">User Interface</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Accessibility_guidelines">Accessibility guidelines</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Toolbar button</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Address bar button</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Sidebars</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Context menu items</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Options page</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Extension pages</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Address bar suggestions</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Developer tools panels</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>How to</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercept HTTP requests</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modify a web page</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insert external content</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Add a button to the toolbar</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Implement a settings page</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">Work with the Tabs API</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">Work with the Bookmarks API</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">Work with the Cookies API</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Work with contextual identities</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/onboarding_upboarding_offboarding_best_practices">Onboard, upboard, and offboard users</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Porting</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Porting_a_Google_Chrome_extension">Porting a Google Chrome extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Porting_a_legacy_Firefox_add-on">Porting a legacy Firefox extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_the_Add-on_SDK">Comparison with the Add-on SDK</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions">Comparison with XUL/XPCOM extensions</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">Differences between API implementations</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Chrome incompatibilities</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Differences_between_desktop_and_Android">Differences between desktop and Android</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Firefox workflow</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Development_Tools">Developer tools</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Choose_a_Firefox_version_for_web_extension_develop">Choose a Firefox version</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/User_experience_best_practices">User Experience</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Prompt_users_for_data_and_privacy_consents">Prompt users for data and privacy consents</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox">Temporary Installation in Firefox</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Debugging">Debugging</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Testing_persistent_and_restart_features">Testing persistent and restart features</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Test_permission_requests">Test permission requests</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Developing_WebExtensions_for_Firefox_for_Android">Developing for Firefox for Android</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Getting_started_with_web-ext">Getting started with web-ext</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/web-ext_command_reference">web-ext command reference</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/WebExtensions_and_the_Add-on_ID">Extensions and the Add-on ID</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Request_the_right_permissions">Request the right permissions</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Best_practices_for_updating_your_extension">Best practices for updating your extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>JavaScript APIs</summary>
        <ol><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li></ol>
      </details>
    </li>

    <li class="toggle">
      <details>
      <summary>Manifest keys</summary>
      <ol><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">ключ background</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">ключ icons</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">ключ manifest_version</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">ключ name</a></li><li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">ключ version</a></li></ol>
      </details>
    </li>
    <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Distribution_options">Distribution Options</a></li>
    <li><a href="/ru/docs/Mozilla/Add-ons/Themes"><strong>Themes</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Browser themes</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/Themes/Theme_concepts">Browser theme concepts</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Themes/Using_the_AMO_theme_generator">Using the AMO theme generator</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/ru/docs/Mozilla/Add-ons/Distribution"><strong>Publishing and Distribution</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Publishing add-ons</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Developer_accounts">Developer accounts</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution">Signing and distribution overview</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Package_your_extension_">Package your extension</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution/Submitting_an_add-on">Submit an add-on</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Source_Code_Submission">Source code submission</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution/Resources_for_publishers">Resources for publishers</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Listing">Creating an appealing listing</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution/Make_money_from_browser_extensions">Make money from browser extensions</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution/Promoting_your_extension_or_theme">Promoting your extension or theme</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/AMO/Policy/Reviews">Add-on policies</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/AMO/Policy/Agreement">Developer agreement</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/AMO/Policy/Featured">Featured add-ons</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/Distribution/Retiring_your_extension">Retiring your extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Distributing add-ons</summary>
        <ol>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Sideloading_add-ons">For sideloading</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_for_desktop_apps">For desktop apps</a></li>
          <li><a href="/ru/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_in_the_enterprise">For an enterprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/ru/docs/Mozilla/Add-ons/Contact_us"><strong>Contact us</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Channels</summary>
        <ol>
          <li><a href="https://blog.mozilla.org/addons">Add-ons blog</a></li>
          <li><a href="https://discourse.mozilla.org/c/add-ons">Add-ons forum</a></li>
          <li><a href="https://chat.mozilla.org/#/room/%23addons:mozilla.org">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</section></div>

<p>API <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions">WebExtensions</a> предоставляет полезный модуль для интернационализации расширений — <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n">i18n</a>. В этой статье мы рассмотрим его особенности и пример его работы. Система для расширений, построенных с помощью API WebExtension, i18n похожа на библиотеки JavaScript для i18n, такие как <a href="http://i18njs.com/">i18n.js</a>.</p>

<div class="note">
<p>Расширение, используемое в этой статье в качестве примера, — <a href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n">notify-link-clicks-i18n</a> — доступно на GitHub. Читая последующие секции этой статьи, Вы можете исследовать его исходный код.</p>
</div>

<h2 id="Структура_интернализированного_расширения">Структура интернализированного расширения</h2>

<p>Интернационализированное расширение может содержать такие же элементы, как и любое другое расширение — <a href="/en-US/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Background_scripts">фоновые скрипты</a>, <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">встраиваемые скрипты</a>, и т. д. — а также дополнительные инструмены, позволяющие переключаться между разными локализациями. Их можно представить следующим деревом директорий:</p>

<ul class="directory-tree">
 <li>корневая-директория-расширения/
  <ul>
   <li>_locales
    <ul>
     <li>en
      <ul>
       <li>messages.json
        <ul>
         <li>Сообщения на английском (строки)</li>
        </ul>
       </li>
      </ul>
     </li>
     <li>de
      <ul>
       <li>messages.json
        <ul>
         <li>Сообщения на немецком (строки)</li>
        </ul>
       </li>
      </ul>
     </li>
     <li>и т. д.</li>
    </ul>
   </li>
   <li>manifest.json
    <ul>
     <li>Метаданные, зависящие от локализации</li>
    </ul>
   </li>
   <li>myJavascript.js
    <ul>
     <li>Файл JavaScript, получающий локализацию браузера, сообщения, зависящие от локализации, и т. д.</li>
    </ul>
   </li>
   <li>myStyles.css
    <ul>
     <li>CSS, зависящий от локализации</li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

<p>Давайте отдельно рассмотрим каждый элемент — последующие секции представляют собой шаги, которым стоит следовать во время интернационализации вашего расширения.</p>

<h2 id="Добавление_локализованных_строк_в__locales">Добавление локализованных строк в _locales</h2>

<div class="pull-aside">
<div class="moreinfo">Вы можете определить тэг языка при помощи инструмента <em>Find</em>  на <a href="https://r12a.github.io/app-subtags/">странице определения языковых тегов</a>. Обратите внимание на то, что при поиске еужно использовать английское название языка</div>
</div>

<p>Каждая система i18n требует предоставить строки во всех локализациях, которые Вы хотите поддерживать. В расширениях они хранятся в директории  <code>_locales</code>, размещенной внутри корневой директории. Строки каждой локализации (также называемые сообщениями) хранятся в файле <code>messages.json</code>, находящемся в поддиректории <code>_locales</code>, название которой - тег языка локализации.</p>

<p>Стоит заметить, что если тег включает в себя и базовый язык, и его региональный вариант, то по конвенции эти язык и вариант разделяются дефисом: например, &quot;en-US&quot;. Однако в поддиректориях <code>_locales</code>, <strong>вместо дефиса используется нижнее подчеркивание</strong>: &quot;en_US&quot;.</p>

<p>Таким образом, <a href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n/_locales">в нашем примере</a> существую директории &quot;en&quot; (английский), &quot;de&quot; (немецкий), &quot;nl&quot; (голландский), and &quot;ja&quot; (японский). Внутри каждой из них находится файл <code>messages.json</code> .</p>

<p>Давайте рассмотрим структуру одного из этих файлов (<a href="https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/_locales/en/messages.json">_locales/en/messages.json</a>):</p>

<pre class="brush: json notranslate">{
  &quot;extensionName&quot;: {
    &quot;message&quot;: &quot;Notify link clicks i18n&quot;,
    &quot;description&quot;: &quot;Name of the extension.&quot;
  },

  &quot;extensionDescription&quot;: {
    &quot;message&quot;: &quot;Shows a notification when the user clicks on links.&quot;,
    &quot;description&quot;: &quot;Description of the extension.&quot;
  },

  &quot;notificationTitle&quot;: {
    &quot;message&quot;: &quot;Click notification&quot;,
    &quot;description&quot;: &quot;Title of the click notification.&quot;
  },

  &quot;notificationContent&quot;: {
    &quot;message&quot;: &quot;You clicked $URL$.&quot;,
    &quot;description&quot;: &quot;Tells the user which link they clicked.&quot;,
    &quot;placeholders&quot;: {
      &quot;url&quot; : {
        &quot;content&quot; : &quot;$1&quot;,
        &quot;example&quot; : &quot;https://developer.mozilla.org&quot;
      }
    }
  }
}</pre>

<p>Это стандартный файл JSON — каждый из его элементов является объектом с именем, содержащим сообщение (<code>message)</code> и описание (<code>description)</code>. Оба предмета - строки; <code>$URL$</code> — это заполнитель, который заменяется подстрокой, когда элемент <code>notificationContent</code> вызывается расширением. Вы научитесь это делать в секции <a href="#Получение_сообщений_из JavaScript">Получение сообщений из JavaScript</a>.</p>

<div class="note">
<p><strong>Примечание</strong>: Вы можете найти больше информации о структуре <code>messages.json</code> <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/Locale-Specific_Message_reference">здесь</a>.</p>
</div>

<h2 id="Интернационализация_manifest.json">Интернационализация manifest.json</h2>

<p>Для интернационализации файла manifest.json нужно предпринять несколько шагов.</p>

<h3 id="Получение_локализованных_строк_в_манифестах">Получение локализованных строк в манифестах</h3>

<p>Ваш файл <a href="https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/manifest.json">manifest.json</a> содержит строки, отображаемые пользователю, такие как имя и описание расширения. Если Вы интернационализируете эти строки и поместите их переводы в messages.json, то эти переводы будут отображаться пользователю в зависимости от локализации его браузера.</p>

<p>Чтобы интернационализировать строки, их нужно указывать следующим образом:</p>

<pre class="brush: json notranslate">&quot;name&quot;: &quot;__MSG_extensionName__&quot;,
&quot;description&quot;: &quot;__MSG_extensionDescription__&quot;,</pre>

<p>Здесь мы получаем сообщения, зависящие от локализации браузера, а не просто статические строки.</p>

<p>Чтобы получить строку сообщения, ее нужно указать следующим образом:</p>

<ol>
 <li>Два подчеркивания</li>
 <li>Строка &quot;MSG&quot;</li>
 <li>Одно подчеркивание</li>
 <li>Имя сообщения так как оно указано в <code>messages.json</code></li>
 <li>Два подчеркивания</li>
</ol>

<pre class="notranslate"><strong>__MSG_</strong> + <em>messageName</em> + <strong>__</strong></pre>

<h3 id="Локализация_по_умолчанию">Локализация по умолчанию</h3>

<p>Еше одно поле. которое нужно указать в manifest.json — это <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a>:</p>

<pre class="brush: json notranslate">&quot;default_locale&quot;: &quot;en&quot;</pre>

<p>Этот параметр устанавливает локализацию по умолчанию, используемую, если расширение не поддерживает локализацию браузера пользователя. Любые сообщения, недоступные в текущей локализации, будут браться из той локализации, которая установлена по умолчанию. There are some more details to be aware of in terms of how the browser selects strings — see <a href="#Выбор_локализованной_строки">Выбор локализованной строки</a>.</p>

<h2 id="CSS_зависящий_от_локализации">CSS, зависящий от локализации</h2>

<p>Локализованные строки также можно получить из CSS-файлов расширения. Например, Вы можете создать поля CSS, зависящие от локализации, так:</p>

<pre class="brush: css notranslate">header {
  background-image: url(../images/__MSG_extensionName__/header.png);
}</pre>

<p>Этот функционал может быть полезен, однако, возможно, для этих целей стоит использовать <a href="#Заранее_определенные_сообщения">Заранее определенные сообщения</a>.</p>

<h2 id="Получение_сообщений_из_JavaScript">Получение сообщений из JavaScript</h2>

<p>Допустим, Вы добавили сообщения в Ваш manifest.json. Чтобы Ваше расширение начало использовать правильные языки, соответствующие сообщения следует вызывать при помощи JavaScript. <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n">API i18n</a> достаточно прост и содержит всего 4 основных метода:</p>

<ul>
 <li>Скорее всего, наиболее часто Вы будете использовать <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage"><code>i18n.getMessage()</code></a> — этот сетод используется для получения конкретного сообщения. Примеры его использования можно увидеть ниже.</li>
 <li>Методы <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getAcceptLanguages"><code>i18n.getAcceptLanguages()</code></a> и <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getUILanguage"><code>i18n.getUILanguage()</code></a> используются, если UI надо менять в зависимости от локализации — например, если Вы хотите, чтобы предпочтения, свойственные носителям какого-либо языка, находились выше в списке, или чтобы формат дат соответствовал локализации браузера.</li>
 <li>Метод <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/detectLanguage"><code>i18n.detectLanguage()</code></a> используется для получения языка информации, введенной пользователем, и ее форматирования.</li>
</ul>

<p>В нашем примере <a href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n">notify-link-clicks-i18n</a> , <a href="https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/background-script.js">фоновый скрипт</a> содержит следующие строки:</p>

<pre class="brush: js notranslate">var title = browser.i18n.getMessage(&quot;notificationTitle&quot;);
var content = browser.i18n.getMessage(&quot;notificationContent&quot;, message.url);</pre>

<p>Первая из них получает поле <code>notificationTitle message</code> из доступного файла <code>messages.json</code>, соответствующее наиболее подходящей локализации . Вторая строка похожа на первую, но в ней метод принимает URL в качестве второго параметра. Зачем? С помощью этого параметра мы указываем, на что нужно заменить заполнитель <code>$URL$</code> в поле <code>notificationContent message</code>:</p>

<pre class="brush: json notranslate">&quot;notificationContent&quot;: {
  &quot;message&quot;: &quot;You clicked $URL$.&quot;,
  &quot;description&quot;: &quot;Tells the user which link they clicked.&quot;,
  &quot;placeholders&quot;: {
    &quot;url&quot; : {
      &quot;content&quot; : &quot;$1&quot;,
      &quot;example&quot; : &quot;https://developer.mozilla.org&quot;
    }
  }
}
</pre>

<p>Объект <code>&quot;placeholders&quot;</code>  определяет все заполнители и то, откуда их нужно получать. Заполнитель <code>&quot;url&quot;</code> указывает, что информация о нем должна содержаться в $1 — первое значение, заданное внутри второго параметра <code>getMessage()</code>. Поскольку заролнитель называется <code>&quot;url&quot;</code>,  <code>$URL$</code> используется для его вызова внутри сообщения (то есть для заполнителя <code>&quot;name&quot;</code> нужно использовать <code>$NAME$</code>, и т. д.). Если Вы хотите задать значения нескольких заполнителей, их можно передавать во второй аргумент <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>i18n.getMessage()</code></a> в виде массива — массив <code>[a, b, c]</code> передает значения <code>$1</code>, <code>$2</code> и <code>$3</code>, и т. д. внутрь <code>messages.json</code>.</p>

<p>Давайте посмотрим на пример: изначально сообщение <code>notificationContent</code> в файле <code>en/messages.json</code> такое:</p>

<pre class="notranslate">You clicked $URL$.</pre>

<p>Пусть эта ссылка указывает на <code>https://developer.mozilla.org</code>. После вызова <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage" title="Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!"><code>i18n.getMessage()</code></a>, содержание второго параметра становится доступно в messages.json в качестве значения <code>$1</code>, замещающего <code>$URL$</code>, так как это указано в заполнителе  <code>&quot;url&quot;</code>. Таким образом, итоговое значение строки:</p>

<pre class="notranslate">You clicked https://developer.mozilla.org.</pre>

<h3 id="Прямое_использование_заполнителей">Прямое использование заполнителей</h3>

<p>Переменные (<code>$1</code>, <code>$2</code>, <code>$3</code>, и т. д.) можно вставлять напрямую в сообщения. Например, можно переписать объект <code>&quot;notificationContent&quot;</code> следующим образом:</p>

<pre class="brush: json notranslate">&quot;notificationContent&quot;: {
  &quot;message&quot;: &quot;You clicked $1.&quot;,
  &quot;description&quot;: &quot;Tells the user which link they clicked.&quot;
}</pre>

<p>Этот метод может показаться более быстрым и простым, но другой способ (использование <code>&quot;placeholders&quot;</code>) считается лучшей практикой. Это вызвано тем, что имена заполнителей (например <code>&quot;url&quot;</code>) и примеры помогают понять, что означают заполнители — через неделю после написания кода Вы, наверное, забудете, что обозначают заполнители <code>$1</code>–<code>$8</code>, что менее вероятно, если заполнители именованы.</p>

<h3 id="Заданные_замены">Заданные замены</h3>

<p>Значения заполнителей можно задавать вручную, если Вы хотите, чтобы каждый раз это значение было одним и тем же, а не определялось переменной в коде. Например:</p>

<pre class="brush: json notranslate">&quot;mdn_banner&quot;: {
  &quot;message&quot;: &quot;For more information on web technologies, go to $MDN$.&quot;,
  &quot;description&quot;: &quot;Tell the user about MDN&quot;,
  &quot;placeholders&quot;: {
    &quot;mdn&quot;: {
      &quot;content&quot;: &quot;https://developer.mozilla.org/&quot;
    }
  }
}</pre>

<p>В этом примере мы сами задаем значение заполнителя, а не получаем его из переменной, такой как <code>$1</code>. Это может быть полезно, если сообщение очень сложное, и Вы хотите разделить значения, чтобы сделать строки более читаемыми. К тому же, доступ к этим значениям можно получить внутри программы.</p>

<p>Вы также можете использовать такие замены для указания частей строки, не нуждающихся в переводе, таких как имена или названия.</p>

<h2 id="Выбор_локализованной_строки">Выбор локализованной строки</h2>

<p>Локализации могут быть указаны с помощью кода языка, например <code>fr</code> или <code>en</code>. Они также могут содержать региональный код, например <code>en_US</code> или <code>en_GB</code>, описывающий региональный вариант языка. Когда вы запрашиваете строку у системы i18n, системы возвращает ее используя следующий алгоритм:</p>

<ol>
 <li>Если для текущей локализации существует файл <code>messages.json</code>, содержащий требуемую строку, возвращается она.</li>
 <li>Иначе,если текущая локализация — региональный вариант (например <code>en_US</code>) и существует файл <code>messages.json</code> для этого языка, но без указания региона  (например <code>en</code>), содержащий строку, возвращается она.</li>
 <li>Иначе, если существует файл <code>messages.json</code> для <code>default_locale</code>, указанной в <code>manifest.json</code>, и этот файл содержит нужную строку, возвращается она.</li>
 <li>В противном случае возвращается пустая строка.</li>
</ol>

<p>Рассмотрим следующий пример:</p>

<ul class="directory-tree">
 <li>корневая-директория-расширения/
  <ul>
   <li>_locales
    <ul>
     <li>en_GB
      <ul>
       <li>messages.json
        <ul>
         <li><code>{ &quot;colorLocalised&quot;: { &quot;message&quot;: &quot;colour&quot;, &quot;description&quot;: &quot;Color.&quot; }, ... }</code></li>
        </ul>
       </li>
      </ul>
      en

      <ul>
       <li>messages.json
        <ul>
         <li><code>{ &quot;colorLocalised&quot;: { &quot;message&quot;: &quot;color&quot;, &quot;description&quot;: &quot;Color.&quot; }, ... }</code></li>
        </ul>
       </li>
      </ul>
     </li>
     <li>fr
      <ul>
       <li>messages.json
        <ul>
         <li><code>{ &quot;colorLocalised&quot;: { &quot;message&quot;: &quot;<span lang="fr">couleur</span>&quot;, &quot;description&quot;: &quot;Color.&quot; }, ...}</code></li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

<p>Пусть <code>default_locale</code> установлен как <code>fr</code>, а текущая локализация браузера — <code>en_GB</code>:</p>

<ul>
 <li>Вызов <code>getMessage(&quot;colorLocalised&quot;)</code> вернет &quot;colour&quot;.</li>
 <li>Если бы в <code>en_GB</code> не было &quot;colorLocalized&quot;, то вызов <code>getMessage(&quot;colorLocalised&quot;)</code>, вернул бы &quot;color&quot;, а не &quot;couleur&quot;.</li>
</ul>

<h2 id="Заранее_определенные_сообщения">Заранее определенные сообщения</h2>

<p>Модуль i18n module предоставляет заранее определенные сообщения, которые можно вызвать таким же образом, как мы это делали в разделе <a href="#Интернационализация_manifest.json">Интернационализация manifest.json</a>. Например:</p>

<pre class="notranslate">__MSG_extensionName__</pre>

<p>Заранее определенные сообщения используют такой же синтаксис, за исключением <code>@@</code> перед именем сообщения, например:</p>

<pre class="notranslate">__MSG_@@ui_locale__</pre>

<p>Следующая таблица содержит различные заранее определенные сообщения:</p>

<table class="standard-table">
 <thead>
  <tr>
   <th scope="col">Message name</th>
   <th scope="col">Description</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><code>@@extension_id</code></td>
   <td>
    <p>Внутренний UUID расширения. Эту строку можно использовать для создания URL ресурсов внутри расширения.Даже нелокализованные расширения могут использовать это сообщения.</p>

    <p>Это сообщения нельзя использовать в manifest.json.</p>

    <p>Также стоит заметить, что этот ID — <em>не</em> ID аддона, которое возвращает <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/runtime/id"><code>runtime.id</code></a>, и которое может быть установлено с помощью ключа <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/applications">applications</a> в manifest.json. Это сгенерированный UUID, содержащийся в URL аддона. Это означает, что данную величину нельзя использовать в качестве параметра <code>extensionId</code>  метода <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage"><code>runtime.sendMessage()</code></a>, или для проверки поля <code>id</code> объекта <a href="/ru/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender"><code>runtime.MessageSender</code></a>.</p>
   </td>
  </tr>
  <tr>
   <td><code>@@ui_locale</code></td>
   <td>Текущая локализация; эту строку можно использовать для создания URL, зависящих от локализации.</td>
  </tr>
  <tr>
   <td><code>@@bidi_dir</code></td>
   <td>Направления чтения, либо &quot;ltr&quot; для языков, таких как английский, где текст читается слева направо, либо &quot;rtl&quot; для языков, считающихся справа налево, таких как арабский.</td>
  </tr>
  <tr>
   <td><code>@@bidi_reversed_dir</code></td>
   <td>Если <code>@@bidi_dir</code> имеет значение &quot;ltr&quot;, то возвращает &quot;rtl&quot;; иначе &quot;ltr&quot;.</td>
  </tr>
  <tr>
   <td><code>@@bidi_start_edge</code></td>
   <td>Если <code>@@bidi_dir</code> имеет значение &quot;ltr&quot;, то возвращает &quot;left&quot;; иначе &quot;right&quot;.</td>
  </tr>
  <tr>
   <td><code>@@bidi_end_edge</code></td>
   <td>Если <code>@@bidi_dir</code> имеет значение &quot;ltr&quot;, то возвращает &quot;right&quot;; иначе &quot;left&quot;.</td>
  </tr>
 </tbody>
</table>

<p>Возвращаясь к нашему примеру, лучше было бы написать:</p>

<pre class="brush: css notranslate">header {
  background-image: url(../images/__MSG_@@ui_locale__/header.png);
}</pre>

<p>Теперь мы можем хранить изображения в директориях поддерживаемых локализаций — en, de, и т. д. — что выглядит логичней.</p>

<p>Давайте рассмотрим пример использования сообщений <code>@@bidi_*</code> в файле CSS:</p>

<pre class="brush: css notranslate">body {
  direction: __MSG_@@bidi_dir__;
}

div#header {
  margin-bottom: 1.05em;
  overflow: hidden;
  padding-bottom: 1.5em;
  padding-__MSG_@@bidi_start_edge__: 0;
  padding-__MSG_@@bidi_end_edge__: 1.5em;
  position: relative;
}</pre>

<p>Для языков, в которых текст читается слева направо, таких как английский, правила CSS, использующие заранее определенные сообщения, сверху задают такие значения:</p>

<pre class="brush: css notranslate">direction: ltr;
padding-left: 0;
padding-right: 1.5em;
</pre>

<p>Для языков, читающихся справа налево, значения будут следующими:</p>

<pre class="brush: css notranslate">direction: rtl;
padding-right: 0;
padding-left: 1.5em;</pre>

<h2 id="Тестирование_расширения">Тестирование расширения</h2>

<p>Начиная с Firefox 45, расширения могут быть временно установлены с диска — подробнее об этом написано в статье <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Packaging_and_installation#Loading_from_disk">Loading from disk</a>. Сделайте это и попробуйте протестировать наше расширение <a href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n">notify-link-clicks-i18n</a>. Перейдите на одну из Ваших любимых страниц и нажмите на ссылку, чтобы проверить, появляется ли сообщения, содержащее URL нажатой ссылки.</p>

<p>Затем измените локализацию Firefox на какую-либо поддерживающуюся расширением, которое Вы хотите протестировать.</p>

<ol>
 <li>Откройте &quot;about:config&quot; в Firefox, и найдите параметр <code>intl.locale.requested</code> (обратите внимание на версию Firefox: в версиях до Firefox 59 этот параметр называется <code>general.useragent.locale</code>).</li>
 <li>Если параметр существует, нажмите на него дважды (или нажмите Return/Enter), чтобы выбрать его, введите языковой код локализации, которую Вы хотите протестировать и нажмите &quot;OK&quot; (или Return/Enter). Например, в нашем примере расширение поддерживает &quot;en&quot; (английский), &quot;de&quot; (немецкий), &quot;nl&quot; (голландский), and &quot;ja&quot; (японский). Вы также можете указать пустую строку (<code>&quot;&quot;</code>) в качестве значения. В этом случае браузер выберет язык Вашей ОС по умолчанию.</li>
 <li>Если параметр <code>intl.locale.requested</code> не существует, нажмите правой кнопкой мыши на список параметров (или откройте контекстное меню при помощи клавиатуры), и выберите &quot;New&quot;, а затем &quot;String&quot;. Введите <code>intl.locale.requested</code> как имя настройки и, &quot;de&quot;, &quot;nl&quot;, и т. д. как значение, как это описано в шаге 2.</li>
 <li>Найдите <code>intl.locale.matchOS</code> и, если параметр существует и равен <code>true</code>, дважды нажмите на него и установите на <code>false</code>.</li>
 <li>Перезапустите браузер, чтобы изменения вступили в силу.</li>
</ol>

<div class="note">
<p><strong>Примечание</strong>: Этот метод работает, даже если у Вас не установлен <a href="https://addons.mozilla.org/en-US/firefox/language-tools/">языковой пакет</a> для выбранного языка. В этом случае UI браузера просто будет использовать Ваш язык по умолчанию.</p>
</div>

<ol>
</ol>

<div class="note">
<p><strong>Примечание:</strong> Чтобы изменить результат <code>getUILanguage</code> требуется языковой пакет, поскольку он отражает язык UI браузера, а не язык сообщений расширения.</p>
</div>

<p>Еше раз загрузите расширение с диска и протестируйте локализацию:</p>

<ul>
 <li>Еще раз откройте &quot;about:addons&quot; — теперь Вы должны увидеть Ваше расширение, его иконку, имя и описание на выбранном языке.</li>
 <li>Еще раз протестируйте расширение. Для нашего примера, Вам следовало бы посетить другую страницу и, нажав на ссылку, проверить, появляется ли сообщение на нужном языке.</li>
</ul>

<div class="intrinsic-wrapper"><div class="intrinsic-container "><iframe src="https://www.youtube.com/embed/R7--fp5pPGg?rel=0&amp;html5=1"></iframe></div></div>
