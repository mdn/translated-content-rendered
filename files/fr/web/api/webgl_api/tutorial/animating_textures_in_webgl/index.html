---
title: Animation de textures en WebGL
slug: Web/API/WebGL_API/Tutorial/Animation_de_textures_en_WebGL
tags:
  - Media
  - Tutoriel
  - Video
  - WebGL
translation_of: Web/API/WebGL_API/Tutorial/Animating_textures_in_WebGL
---
<p></p><section id="Quick_Links">
 <ol>
  <li><a href="/fr/docs/Web/API/WebGL_API"><strong>WebGL API</strong></a></li>
  <li class="toggle">
    <details open>
      <summary>WebGL tutoriel</summary>
      <ol>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL">Commencer avec WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Adding_2D_content_to_a_WebGL_context">Ajouter du contenu à WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Using_shaders_to_apply_color_in_WebGL">Ajouter des couleurs avec les shaders</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Animating_objects_with_WebGL">Animer des objets avec WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Creating_3D_objects_using_WebGL">Créer des objets 3D avec WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL">Utiliser les textures avec WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL">Lighting in WebGL</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Tutorial/Animating_textures_in_WebGL">Animating textures in WebGL</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details open>
      <summary>Examples and articles</summary>
      <ol>
        <li><a href="/fr/docs/Web/API/WebGL_API/Matrix_math_for_the_web">Matrix math for the web</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/WebGL_model_view_projection">WebGL model view projection</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/WebGL_best_practices">WebGL best practices</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Using_Extensions">Using WebGL extensions</a></li>
        <li><a href="/fr/docs/Web/API/WebGL_API/Basic_2D_animation_example">A basic 2D WebGL animation example</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details open>
      <summary>Interfaces</summary>
      <ol>
        <li><a href="/fr/docs/Web/API/WebGLRenderingContext"><code>WebGLRenderingContext</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGL2RenderingContext"><code>WebGL2RenderingContext</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLActiveInfo"><code>WebGLActiveInfo</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLBuffer"><code>WebGLBuffer</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLContextEvent"><code>WebGLContextEvent</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLFramebuffer"><code>WebGLFramebuffer</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLProgram"><code>WebGLProgram</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLQuery"><code>WebGLQuery</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLRenderbuffer"><code>WebGLRenderbuffer</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLSampler"><code>WebGLSampler</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLShader"><code>WebGLShader</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLShaderPrecisionFormat"><code>WebGLShaderPrecisionFormat</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLSync"><code>WebGLSync</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLTexture"><code>WebGLTexture</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLTransformFeedback"><code>WebGLTransformFeedback</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLUniformLocation"><code>WebGLUniformLocation</code></a></li>
        <li><a href="/fr/docs/Web/API/WebGLVertexArrayObject"><code>WebGLVertexArrayObject</code></a></li>
      </ol>
    </details>
  </li>

  <li><strong><a href="/fr/docs/MDN">Documentation:</a></strong></li>
  <li class="toggle">
    <details>
      <summary>Listes utiles</summary>
      <ol>
        <li><a href="/fr/docs/tag/WebGL">Pages étiquetées &quot;WebGL&quot;</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Contribuer</summary>
      <ol>
        <li><a href="/fr/docs/MDN/Doc_status/API/WebGL">Statut de la documentation</a></li>
        <li><a href="/fr/docs/MDN">Le projet MDN</a></li>
      </ol>
    </details>
  </li>
 </ol>
</section> <div style="text-align: right;" class="prevnext">
    <p><a style="float: left;" href="/fr/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL" class="button">« Précédent</a><br></p>
</div><p></p>

<p>Dans cette démonstration, nous construisons sur l&apos;exemple précédent en remplaçant nos textures statiques par les images d&apos;un fichier vidéo mp4 en cours de lecture. C&apos;est en fait assez facile à faire, mais c&apos;est amusant à regarder, alors commençons. Un code similaire peut être réalisé pour utiliser n&apos;importe quel type de données (comme un <a href="/fr/docs/Web/HTML/Element/canvas" title="L&apos;élément &lt;canvas&gt; permet de modifier une zone graphique via un script (habituellement en JavaScript ou grâce à WebGL). Il peut par exemple être utilisé afin de dessiner des graphiques, manipuler des images ou jouer des animations."><code>&lt;canvas&gt;</code></a>) comme source pour vos textures..</p>

<h2 id="Accéder_à_la_vidéo">Accéder à la vidéo</h2>

<p>La première étape consiste à créer l&apos;élément <a href="/fr/docs/Web/HTML/Element/video" title="L&apos;élément HTML &lt;video&gt; intègre un contenu vidéo dans un document."><code>&lt;video&gt;</code></a> que nous utiliserons pour récupérer les images vidéo :</p>

<pre class="brush: js">// sera mis à true quand la vidéo pourra être copiée dans la texture
var copierVideo = false;

function configurerVideo(url) {
  const video = document.createElement(&apos;video&apos;);

  var playing = false;
  var timeupdate = false;

  video.autoplay = true;
  video.muted = true;
  video.loop = true;

  <code>// </code>Le fait d&apos;attendre ces 2 évènements assure<code>
  // </code>qu&apos;il y a des données dans la vidéo

  video.addEventListener(&apos;playing&apos;, function() {
     playing = true;
     verifierPret();
  }, true);

  video.addEventListener(&apos;timeupdate&apos;, function() {
     timeupdate = true;
     verifierPret();
  }, true);

  video.src = url;
  video.play();

  function verifierPret() {
    if (playing &amp;&amp; timeupdate) {
      copierVideo = true;
    }
  }

  return video;
}
</pre>

<p>D&apos;abord, nous créons un élément vidéo. Nous le mettons en lecture automatique, nous coupons le son et nous faisons tourner la vidéo en boucle. Nous configurons ensuite 2 événements pour voir que la vidéo est en cours de lecture et que le temps a été mis à jour. Nous avons besoin de ces deux vérifications, car c&apos;est une erreur que d&apos;essayer de télécharger sur WebGL une vidéo qui n&apos;a pas encore de données disponibles. La vérification de ces deux événements garantit que des données sont disponibles et que l&apos;on peut démarrer en toute sécurité le chargement de la vidéo dans une texture WebGL. Dans le code ci-dessus, nous vérifions si nous avons reçu ces deux événements et si c&apos;est le cas, nous mettons une variable globale, <code>copierVideo</code>, à true pour nous dire qu&apos;il est possible de commencer à copier la vidéo dans une texture.</p>

<p>Et enfin, nous définissons l&apos;attribut <code>src</code> pour commencer, et nous appelons <code>play</code> pour démarrer le chargement et la lecture de la vidéo.</p>

<h2 id="Utilisation_des_images_vidéo_comme_texture">Utilisation des images vidéo comme texture</h2>

<p>La prochaine modification porte sur <code>initTexture()</code>, qui devient beaucoup plus simple, car elle n&apos;a plus besoin de charger un fichier image. A la place, tout ce qu&apos;elle fait est de créer un objet texture vide, d&apos;y mettre un unique pixel et de définir son filtrage pour une utilisation ultérieure :</p>

<pre class="brush: js">function initTexture(gl, url) {
  const texture = gl.createTexture();
  gl.bindTexture(gl.TEXTURE_2D, texture);

<code>  // </code>Parce que la vidéo doit être téléchargée depuis sur Internet,<code>
  // </code>cela peut prendre un certain temps jusqu&apos;à ce qu&apos;elle soit prête, donc<code>
  // </code>mettre un seul pixel dans la texture, de façon à ce que nous puissions<code>
  // </code>l&apos;utiliser immédiatement.
  const niveau = 0;
  const formatInterne = gl.RGBA;
  const largeur = 1;
  const hauteur = 1;
  const bordure = 0;
  const formatSrc = gl.RGBA;
  const typeSrc = gl.UNSIGNED_BYTE;
  const pixel = new Uint8Array([0, 0, 255, 255]);  // bleu opaque
  gl.texImage2D(gl.TEXTURE_2D, niveau, formatInterne,
                largeur, hauteur, bordure, formatSrc, typeSrc,
                pixel);

  // Désactiver mips et définir l&apos;emballage comme accroché au bord afin qu&apos;il
  // fonctionne indépendamment des dimensions de la vidéo.
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);

  return texture;
}
</pre>

<div>Voici à quoi ressemble la fonction <code>mettreAJourTexture()</code> ; c&apos;est là où le vrai travail est fait :</div>

<pre class="brush: js">function mettreAJourTexture(gl, texture, video) {
  const niveau = 0;
  const formatInterne = gl.RGBA;
  const formatSrc = gl.RGBA;
  const typeSrc = gl.UNSIGNED_BYTE;
  gl.bindTexture(gl.TEXTURE_2D, texture);
  gl.texImage2D(gl.TEXTURE_2D, niveau, formatInterne,
                formatSrc, typeSrc, video);
}
</pre>

<p>Vous avez déjà vu ce code. Il est presque identique à la fonction onload de l&apos;image dans l&apos;exemple précédent, sauf quand nous appellons <code>texImage2D()</code>, au lieu de passer un objet <code>Image</code>, nous passons l&apos;élément <a href="/fr/docs/Web/HTML/Element/video" title="L&apos;élément HTML &lt;video&gt; intègre un contenu vidéo dans un document."><code>&lt;video&gt;</code></a>. WebGL sait comment extraire l&apos;image en cours et l&apos;utiliser comme texture.</p>

<p>Si <code>copierVideo</code> est true, alors <code>mettreAJourTexture()</code> est appelé à chaque fois juste avant que nous appellions la fonction <code>dessinerScene()</code>.</p>

<pre class="brush: js">  var alors = 0;

  // Dessiner la scène répétitivement
  function dessiner(maintenant) {
    maintenant *= 0.001;  // convertir en seconds
    const ecartTemps = maintenant - alors;
    alors = maintenant;

    if (copierVideo) {
      <code>mettreAJour</code>Texture(gl, texture, video);
    }

    dessinerScene(gl, programInfo, buffers, texture, ecartTemps);

    requestAnimationFrame(dessiner);
  }
  requestAnimationFrame(dessiner);
</pre>

<p>C&apos;est tout pour ce qu&apos;il y a à faire pour cela !</p>

<p><iframe src="https://mdn.github.io/webgl-examples/tutorial/sample8/index.html" width="670" class="live-sample-frame" height="510" frameborder="0"></iframe></p>

<p><a href="https://github.com/mdn/webgl-examples/tree/gh-pages/tutorial/sample8">Voir le code complet</a> | <a href="http://mdn.github.io/webgl-examples/tutorial/sample8/">Ouvrir cette démo dans une nouvelle page</a></p>

<h2 id="Voir_aussi">Voir aussi</h2>

<ul>
 <li><a href="/fr/Using_HTML5_audio_and_video">Utilisation de l&apos;audio et de la video dans Firefox</a></li>
</ul>

<p></p><div style="text-align: right;" class="prevnext">
    <p><a style="float: left;" href="/fr/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL" class="button">« Précédent</a><br></p>
</div><p></p>
