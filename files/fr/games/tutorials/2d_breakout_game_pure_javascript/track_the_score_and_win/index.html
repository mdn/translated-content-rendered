---
title: Suivre le score et gagner
slug: Games/Tutorials/2D_Breakout_game_pure_JavaScript/Track_the_score_and_win
translation_of: Games/Tutorials/2D_Breakout_game_pure_JavaScript/Track_the_score_and_win
original_slug: Games/Workflows/2D_Breakout_game_pure_JavaScript/Track_the_score_and_win
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li class="toggle">
        <details>
            <summary>Introduction</summary>
            <ol>
              <li><a href="/fr/docs/Games/Introduction">Introduction</a></li>
              <li><a href="/fr/docs/Games/Anatomy">Anatomie d&apos;un jeu vidéo</a></li>
              <li><a href="/fr/docs/Games/Examples">Exemples</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>API pour le développement de jeux</summary>
            <ol>
              <li><a href="/fr/docs/Web/API/Canvas_API">Canvas</a></li>
              <li><a href="/fr/docs/Web/CSS">CSS</a></li>
              <li><a href="/fr/docs/Web/Apps/Fundamentals/User_notifications/Full_screen_api">Full Screen (plein écran)</a></li>
              <li><a href="/fr/docs/Web/API/Gamepad_API">Gamepad (manette)</a></li>
              <li><a href="/fr/docs/Web/API/IndexedDB_API">IndexedDB</a></li>
              <li><a href="/fr/docs/Web/JavaScript">JavaScript</a></li>
              <li><a href="/fr/docs/Web/API/Pointer_Lock_API">Pointer Lock (verrou de pointeur)</a></li>
              <li><a href="/fr/docs/Web/SVG">SVG</a></li>
              <li><a href="/fr/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">Typed Arrays (tableaux typés)</a></li>
              <li><a href="/fr/docs/Web/API/Web_Audio_API">Web Audio</a></li>
              <li><a href="/fr/docs/Web/API/WebGL_API">WebGL</a></li>
              <li><a href="/fr/docs/Web/API/WebRTC_API">WebRTC</a></li>
              <li><a href="/fr/docs/Web/API/WebSockets_API">WebSockets</a></li>
              <li><a href="/fr/docs/Web/API/WebVR_API">WebVR (réalité virtuelle)</a></li>
              <li><a href="/fr/docs/Web/API/Web_Workers_API">Web Workers</a></li>
              <li><a href="/fr/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Techniques</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/Async_scripts">Utiliser des scripts asynchrones pour asm.js</a></li>
              <li><a href="/fr/docs/Web/Apps/Developing/Optimizing_startup_performance">Optimiser les performances de démarrage</a></li>
              <li><a href="/fr/docs/Games/Techniques/WebRTC_data_channels">Utiliser WebRTC - canaux de données pair-à-pair</a></li>
              <li><a href="/fr/docs/Games/Techniques/Efficient_animation_for_web_games">Animation efficace pour un jeu internet</a></li>
              <li><a href="/fr/docs/Games/Techniques/Audio_for_Web_Games">Audio pour les jeux web</a></li>
              <li><a href="/fr/docs/Games/Techniques/2D_collision_detection">Détection de collision 2D</a></li>
              <li><a href="/fr/docs/Games/Techniques/Tilemaps">Carreaux et carrelages</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Jeux 3D sur le Web</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web">Aperçu des jeux 3D sur le Web</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Basic_theory">Théorie de base sur la 3D</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_A-Frame">Construire une démo avec A-Frame</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Babylon.js">Construire une démo avec Babylon.js</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_PlayCanvas">Construire une démo avec PlayCanvas</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Three.js">Construire une démo avec Three.js</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/WebVR">WebVR (réalité virtuelle)</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_collision_detection">Détection de collision en 3D</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_collision_detection/Bounding_volume_collision_detection_with_THREE.js">Détection de collision de volumes avec THREE.js</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Mise en place des contrôle du jeu</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms">Aperçu des mécanismes de contrôle du jeu</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Mobile_touch">Commandes tactiles mobiles</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Desktop_with_mouse_and_keyboard">Commandes à la souris et au clavier</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Desktop_with_gamepad">Commandes à la manette</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Other">Contrôles non conventionnels</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Tutoriels</summary>
            <ol>
              <li><a href="/fr/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript">Jeu de casse-briques 2D avec du pur JavaScript</a></li>
              <li><a href="/fr/docs/Games/Tutorials/2D_breakout_game_Phaser">Jeu de casse-tête 2D avec Phaser</a></li>
              <li><a href="/fr/docs/Games/Tutorials/HTML5_Gamedev_Phaser_Device_Orientation">Jeu de labyrinthe 2D avec orientation du périphérique</a></li>
              <li><a href="https://mozdevs.github.io/html5-games-workshop/en/guides/platformer/start-here/">Jeu de plateforme 2D avec Phaser</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Publication de jeux</summary>
            <ol>
              <li><a href="/fr/docs/Games/Publishing_games">Aperçu des outils de publication des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_distribution">Distribution des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_promotion">Promotion des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_monetization">Monétisation des jeux</a></li>
            </ol>
        </details>
    </li>
  </ol>
</section></div>

<div></div>

<div class="prevnext" style="text-align: right;">
    <p><a href="/fr/docs/Games/Workflows/2D_Breakout_game_pure_JavaScript/detection_colisions" style="float: left;" class="button">« Précédent</a><a href="/fr/docs/Games/Workflows/2D_Breakout_game_pure_JavaScript/Mouse_controls" class="button">Suivant  »</a></p>
</div>

<div class="summary">
<p>Ceci est la <strong>8<sup>ème</sup></strong> étape de ce <a href="https://developer.mozilla.org/en-US/docs/Games/Workflows/Breakout_game_from_scratch">tutoriel Gamedev Canvas</a>. Vous pouvez trouver le code source tel qu&apos;il devrait être après avoir terminé cette leçon à : <a href="https://github.com/end3r/Gamedev-Canvas-workshop/blob/gh-pages/lesson08.html">Gamedev-Canvas-workshop/lesson8.html</a>.</p>
</div>

<p>Détruire les briques est vraiment cool, mais pour être encore meilleur le jeu pourrait attribuer des points pour chaque brique touchée et compter le score total.</p>

<h2 id="Calculer_le_score">Calculer le score</h2>

<p>Si vous pouvez voir votre score durant le jeu, vous pourrez impressioner vos amis. Vous avez besoin d&apos;une variable pour stocker le score. Ajoutez ce qui suit dans votre JavaScript après le reste de vos variables : </p>

<pre class="brush: js notranslate">var score = 0;</pre>

<p>Vous avez aussi besoin d&apos;une fonction <code>drawScore()</code>, pour créer et mettre à jour l&apos;affichage du score. Ajoutez ce qui suit après la fonction de détection de collision <code>collisionDetection()</code>:</p>

<pre class="brush: js notranslate">function drawScore() {
    ctx.font = &quot;16px Arial&quot;;
    ctx.fillStyle = &quot;#0095DD&quot;;
    ctx.fillText(&quot;Score: &quot;+score, 8, 20);
}</pre>

<p>Dessiner du texte sur un canvas revient à dessiner une forme. La définition de la police est identique à celle en CSS — vous pouvez définir la taille et le type avec la méthode   <a href="/fr/docs/Web/API/CanvasRenderingContext2D/font"><code>font()</code></a>. Puis utilisez <a href="/fr/docs/Web/API/CanvasRenderingContext2D/fillStyle"><code>fillStyle()</code></a> pour définir la couleur de la police et <a href="/fr/docs/Web/API/CanvasRenderingContext2D/fillText"><code>fillText()</code></a> pour définir la position du texte sur le canevas. Le premier paramètre est le texte lui-même — le code ci-dessus indique le nombre actuel de points — et les deux derniers paramètres sont les coordonnées où le texte est placé sur le canevas.</p>

<p>Pour attribuer le score à chaque collision avec une brique, ajoutez une ligne à la fonction <code>collisionDetection()</code> afin d&apos;incrémenter la valeur de la variable score à chaque détection d&apos;une collision. Ajoutez à votre code la ligne mise en évidence ci-dessous :</p>

<pre class="brush: js; highlight:[9] notranslate">function collisionDetection() {
    for(var c=0; c&lt;brickColumnCount; c++) {
        for(var r=0; r&lt;brickRowCount; r++) {
            var b = bricks[c][r];
            if(b.status == 1) {
                if(x &gt; b.x &amp;&amp; x &lt; b.x+brickWidth &amp;&amp; y &gt; b.y &amp;&amp; y &lt; b.y+brickHeight) {
                    dy = -dy;
                    b.status = 0;
                    <strong>score++;</strong>
                }
            }
        }
    }
}</pre>

<p>Appelez la fonction <code>drawScore()</code> dans la fonction <code>draw()</code> pour garder le score à jour à chaque nouvelle frame — ajoutez la ligne suivante dans la fonction <code>draw()</code>, en dessous de l&apos;appel à <code>drawPaddle()</code> :</p>

<pre class="brush: js notranslate">drawScore();</pre>

<h2 id="Ajoutez_un_message_de_victoire_lorsque_toutes_les_briques_ont_été_détruites">Ajoutez un message de victoire lorsque toutes les briques ont été détruites</h2>

<p>Le comptage des points fonctionne bien, mais vous ne les compterez pas indéfiniment. Alors qu&apos;en est-il du score lorsque toutes les briques ont été détruites ? Après tout c&apos;est l&apos;objectif principal du jeu. Vous devez donc afficher un message de victoire si toutes les briques ont été détruites. Ajoutez la section mise en évidence dans votre fonction <code>collisionDetection()</code>:</p>

<pre class="brush: js; highlight:[10,11,12,13] notranslate">function collisionDetection() {
    for(var c=0; c&lt;brickColumnCount; c++) {
        for(var r=0; r&lt;brickRowCount; r++) {
            var b = bricks[c][r];
            if(b.status == 1) {
                if(x &gt; b.x &amp;&amp; x &lt; b.x+brickWidth &amp;&amp; y &gt; b.y &amp;&amp; y &lt; b.y+brickHeight) {
                    dy = -dy;
                    b.status = 0;
                    score++;
                    <strong>if(score == brickRowCount*brickColumnCount) {
                        alert(&quot;C&apos;est gagné, Bravo!&quot;);
                        document.location.reload();
                        clearInterval(interval); // Needed for Chrome to end game
                    }</strong>
                }
            }
        }
    }
}</pre>

<p>Grâce à ça, les utilisateurs peuvent réellement gagner le jeu. La fonction <code>document.location.reload()</code> recharge la page et redémarre le jeu au clic sur le bouton d&apos;alerte.</p>

<h2 id="Comparez_votre_code">Comparez votre code</h2>

<p>Le code réalisé fonctionne et ressemble à cela, au cas où vous voudriez le comparer avec le vôtre : </p>

<p><iframe frameborder="0" height="395" src="https://jsfiddle.net/raymondjplante/b3z2Lpu9/embedded/" width="100%"></iframe></p>

<div class="note notecard">
<p><strong>Exercice</strong>: Ajoutez plus de points par brique touchée et indiquez le nombre de points gagnés dans la boîte d&apos;alerte de fin de partie.</p>
</div>

<h2 id="Prochaine_étape">Prochaine étape</h2>

<p>Le jeu est plutôt réussi à ce stade. Dans la prochaine leçon, vous le rendrez plus attraynt en ajoutant le <a href="https://developer.mozilla.org/en-US/docs/Games/Workflows/Breakout_game_from_scratch/Mouse_controls">contrôle à la souris</a>.</p>

<div class="prevnext" style="text-align: right;">
    <p><a href="/fr/docs/Games/Workflows/2D_Breakout_game_pure_JavaScript/detection_colisions" style="float: left;" class="button">« Précédent</a><a href="/fr/docs/Games/Workflows/2D_Breakout_game_pure_JavaScript/Mouse_controls" class="button">Suivant  »</a></p>
</div>
