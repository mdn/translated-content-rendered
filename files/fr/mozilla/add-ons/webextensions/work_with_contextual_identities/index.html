---
title: Travailler avec des identités contextuelles
slug: Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities
tags:
  - Add-ons
  - Comment
  - Contextual identities
  - Débutant
  - Extensions
  - Hox-to
  - WebExtensions
translation_of: Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities
original_slug: Mozilla/Add-ons/WebExtensions/travailler_avec_des_identites_contextuelles
---
<section class="Quick_links" id="Quick_Links">
  <ol>
    <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions"><strong>WebExtensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Démarrage</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">Que sont les WebExtensions ?</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Votre première WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Votre deuxième WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomie d&apos;une WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Examples">Exemples de WebExtensions</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/What_next_">Que faire ensuite ?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">Utilisation des API JavaScript</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Scripts de contenu</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Motifs de correspondance (Match patterns)</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Travailler avec les fichiers</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalisation</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices">Sécurité : bonnes pratiques</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Politique de sécurité du contenu</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Message natifs</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Interface Utilisateur</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface">Introduction</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Accessibility_guidelines">Accessibility guidelines</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Bouton de la barre d&apos;outils</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Bouton de la barre d&apos;adresse</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Barres latérales</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Éléments du menu contextuel</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Page d&apos;options</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Pages pour l&apos;extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Suggestions de la barre d&apos;adresse</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Panneaux d&apos;outils de développement</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Mode d&apos;emploi</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercepter les requêtes HTTP</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modifier une page web</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insérer un contenu externe</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Ajouter un bouton à la barre d&apos;outils</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Mettre en place une page de paramètres</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">Travailler avec l&apos;API Tabs</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">Travailler avec l&apos;API Bookmarks</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">Travailler avec l&apos;API Cookies</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Travailler avec des identités contextuelles</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/onboarding_upboarding_offboarding_best_practices">Onboard, upboard, and offboard users</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Portage</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Porting_a_Google_Chrome_extension">Porter une extension Google Chrome</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Porting_a_legacy_Firefox_add-on">Porter une ancienne extension Firefox</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_the_Add-on_SDK">Comparaison avec le SDK Add-on</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions">Comparaison avec les extensions XUL/XPCOM</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">Differences between API implementations</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Incompatibilités avec Chrome</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Differences_between_desktop_and_Android">Différence entre le bureau et Android</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Déroulement avec Firefox</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Development_Tools">Developer tools</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Choose_a_Firefox_version_for_web_extension_develop">Choose a Firefox version</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/User_experience_best_practices">Expérience utilisateur : bonnes pratiques</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Prompt_users_for_data_and_privacy_consents">Prompt users for data and privacy consents</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox">Installation temporaire dans Firefox</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Debugging">Débogage</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Testing_persistent_and_restart_features">Test des fonctionnalités persistantes et de redémarrage</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Test_permission_requests">Test permission requests</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Developing_WebExtensions_for_Firefox_for_Android">Écrire des extensions pour Firefox sur Android</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Getting_started_with_web-ext">Démarrer avec web-ext</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/web-ext_command_reference">Détail de la commande web-ext</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/WebExtensions_and_the_Add-on_ID">Les WebExtensions et l&apos;ID Add-on</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Request_the_right_permissions">Demander les bonnes permissions</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Best_practices_for_updating_your_extension">Bonnes pratiques pour la mise à jour de votre extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Les API JavaScript</summary>
        <ol><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11">pkcs11</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/alarms">alarms</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks">bookmarks</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserAction">browserAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings">browserSettings</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browsingData">browsingData</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/clipboard">clipboard</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/commands">commands</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts">contentScripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities">contextualIdentities</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow">devtools.inspectedWindow</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network">devtools.network</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels">devtools.panels</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/dns">dns</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/events">events</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension">extension</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes">extensionTypes</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/find">find</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/history">history</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n">i18n</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/identity">identity</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/idle">idle</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/management">management</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus">menus</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications">notifications</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/omnibox">omnibox</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/pageAction">pageAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/permissions">permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/privacy">privacy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/proxy">proxy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/search">search</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/sessions">sessions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction">sidebarAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage">storage</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/theme">theme</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/topSites">topSites</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/types">types</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation">webNavigation</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li></ol>
      </details>
    </li>

    <li class="toggle">
      <details>
      <summary>Clés de manifeste</summary>
      <ol><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/auteur">author</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/arriere-plan">background</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides">chrome_settings_overrides</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides">chrome_url_overrides</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands">commands</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page">devtools_page</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries">dictionaries</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url">homepage_url</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">icons</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito">incognito</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled">offline_enabled</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox">omnibox</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions">optional_permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page">options_page</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui">options_ui</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action">page_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers">protocol_handlers</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">short_name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action">sidebar_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme">theme</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name">version_name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li></ol>
      </details>
    </li>
    <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Distribution_options">Distribution Options</a></li>
    <li><a href="/fr/docs/Mozilla/Add-ons/Themes"><strong>Thèmes</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Thème de navigateur</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/Themes/Theme_concepts">Concepts des thèmes</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Themes/Using_the_AMO_theme_generator">Using the AMO theme generator</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/fr/docs/Mozilla/Add-ons/Distribution"><strong>Publication et distribution</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Publication de votre extension</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Developer_accounts">Developer accounts</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution">Signature et distribution de votre extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Package_your_extension_">Zipper votre extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution/Submitting_an_add-on">Soumettre une extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Source_Code_Submission">Soumission du code source</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution/Resources_for_publishers">Ressources pour les développeurs</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Listing">Créer une page attrayante pour votre extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution/Make_money_from_browser_extensions">Make money from browser extensions</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution/Promoting_your_extension_or_theme">Promoting your extension or theme</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/AMO/Policy/Reviews">Processus de revue</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/AMO/Policy/Agreement">Accord développeur</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/AMO/Policy/Featured">Extensions mises en avant</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/Distribution/Retiring_your_extension">Retrait de votre extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Distribuer votre module</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Sideloading_add-ons">Pour une installation manuelle</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_for_desktop_apps">En tant qu&apos;application de bureau</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_in_the_enterprise">Dans un contexte d&apos;entreprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="https://discourse.mozilla.org/c/add-ons"><strong>Communauté et Support</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Canaux de discussions</summary>
        <ol>
          <li><a href="https://blog.mozilla.org/addons">Blog extensions</a></li>
          <li><a href="https://discourse.mozilla.org/c/add-ons">Forum extensions</a></li>
          <li><a href="https://stackoverflow.com/questions/tagged/firefox-addon">Stack Overflow</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/#Contact_us">Nous contacter</a></li>
        </ol>
      </details>
    </li>
  </ol>
</section>

<p>Beaucoup de gens ont besoin ou veulent interagir avec le web en utilisant plusieurs personnages. Ils peuvent avoir des comptes pour le travail sur le Web et le courrier électronique personnel. Ils peuvent se déconnecter de leurs comptes de médias sociaux avant d&apos;accéder aux achats en ligne, afin de s&apos;assurer que les scripts de suivi sur les sites d&apos;achat ne peuvent pas prendre en charge leur activité de médias sociaux. Pour répondre à ces exigences, les utilisateurs finissent souvent par utiliser une fenêtre de navigateur standard et privée ou deux navigateurs différents.</p>

<p>Pour répondre à ce besoin, Firefox inclut une fonctionnalité connue sous le nom d&apos;identités contextuelles, d&apos;onglets de conteneurs ou de conteneurs de comptes. Cette fonctionnalité permet la création d&apos;un conteneur de cookies pour chacune des identités que l&apos;utilisateur souhaite utiliser dans son navigateur. Les onglets peuvent être associés à l&apos;une de ces identités, en conservant les cookies distincts de ceux des autres identités dans le navigateur. Le résultat pratique est que, par exemple, un utilisateur peut avoir une identité personnelle et professionnelle. Ils peuvent ensuite utiliser l&apos;identité personnelle dans un onglet, où ils se connectent à leur messagerie Web personnelle, et l&apos;identité professionnelle dans un autre onglet, où ils se connectent à leur messagerie Web professionnelle.</p>

<p>Pour plus d&apos;informations sur cette fonctionnalité, voir :</p>

<ul>
 <li><a href="https://blog.mozilla.org/firefox/introducing-firefox-multi-account-containers/">Mettez vos multiples personnalités en ligne dans Firefox Multi-Compte ContaYouiners (anglais)</a></li>
 <li><a href="https://wiki.mozilla.org/Security/Contextual_Identity_Project/Containers">Securité / Projet d&apos;identité contextuelle / conteneurs (anglais)</a></li>
 <li><a href="https://support.mozilla.org/fr/kb/onglets-contextuels-avec-les-containers">Article de support Firefox sur les conteneurs (français)</a></li>
</ul>

<h2 id="API_pour_travailler_avec_des_identités_contextuelles">API pour travailler avec des identités contextuelles</h2>

<p>Pour utiliser les fonctionnalités d&apos;identité contextuelle dans les extensions, vous utiliserez deux APIs :</p>

<ul>
 <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities"><code>contextualIdentities</code></a> qui permet à une extension d&apos;ajouter, d&apos;interroger, de mettre à jour et de supprimer des identités contextuelles.</li>
 <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs"><code>tabs</code></a> ou plus précisément <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs/create"><code>tabs.create</code></a> qui vous permet de créer un onglet utilisant le conteneur d&apos;une identité contextuelle (magasin de cookies).</li>
</ul>

<h2 id="Permissions">Permissions</h2>

<p>Pour utiliser l&apos;API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities" title="Travailler avec des identités contextuelles : lister, créer, supprimer et mettre à jour des identités contextuelles."><code>contextualIdentities</code></a> vous devez inclure la  <a href="/fr/Add-ons/WebExtensions/manifest.json/permissions">permission</a> &quot;contextualIdentities&quot; dans votre fichier <a href="/fr/Add-ons/WebExtensions/manifest.json">manifest.json</a>. Vous n&apos;avez pas besoin de la permission &quot;tabs&quot; pour utiliser <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs/create" title="Crée un nouvel onglet"><code>tabs.create</code></a> ; vous avez besoin de la permission &quot;cookies&quot; pour spécifier le conteneur de cookies que vous souhaitez utiliser.</p>

<h2 id="Exemple_de_procédure_pas_à_pas">Exemple de procédure pas à pas</h2>

<p>L&apos;exemple d&apos;extension <a href="https://github.com/mdn/webextensions-examples/tree/master/contextual-identities">contextual-identities</a> fournit un bouton de barre d&apos;outils avec une fenêtre qui répertorie les identités dans le navigateur. Pour chaque identité, l&apos;extension fournit des options permettant de créer un nouvel onglet en utilisant son conteneur de cookies ou de supprimer tous les onglets de l&apos;identité.</p>

<p>Voici une courte vidéo de l&apos;extension en action :</p>

<div class="intrinsic-wrapper"><div class="intrinsic-container "><iframe src="https://www.youtube.com/embed/SgLCS7_ppas?rel=0&amp;html5=1"></iframe></div></div>

<h3 id="manifest.json">manifest.json</h3>

<p>Les principales caractéristiques du fichier <a href="https://github.com/mdn/webextensions-examples/blob/master/contextual-identities/manifest.json">manifest.json</a> sont :</p>

<ul>
 <li>La demande de permissions :
  <pre class="brush: json">  &quot;permissions&quot;: [
      &quot;contextualIdentities&quot;,
      &quot;cookies&quot;
  ],</pre>
 </li>
 <li>spécification du bouton de la barre d&apos;outils (browseAction) donnant accès aux fonctionnalités de l&apos;extension :
  <pre class="brush: json">  &quot;browser_action&quot;: {
    &quot;browser_style&quot;: true,
    &quot;default_title&quot;: &quot;Contextual Identities&quot;,
    &quot;default_popup&quot;: &quot;context.html&quot;,
    &quot;default_icon&quot;: {
      &quot;128&quot;: &quot;identity.svg&quot;
    }</pre>
 </li>
</ul>

<h2 id="context.html">context.html</h2>

<p>Une fenêtre contextuelle sur le bouton de la barre d&apos;outils fournit l&apos;interface utilisateur de l&apos;extension. <a href="https://github.com/mdn/webextensions-examples/blob/master/contextual-identities/context.html">context.html</a> implémente ce popup, mais c&apos;est juste un shell dans lequel le script context.js écrit la liste des identités contextuelles et leurs options associées.</p>

<pre class="brush: html">  &lt;body&gt;
    &lt;div class=&quot;panel&quot;&gt;
      &lt;div id=&quot;identity-list&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;script src=&quot;context.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;</pre>

<h2 id="context.js">context.js</h2>

<p>Toutes les fonctionnalités de l&apos;extension sont implémentées via <a href="https://github.com/mdn/webextensions-examples/blob/master/contextual-identities/context.js">context.js</a>, qui est appelée chaque fois que la barre d&apos;outils est affichée.</p>

<p>Le script obtient d&apos;abord le div &apos;identity-list&apos; depuis context.html.</p>

<pre class="brush: json">var div = document.getElementById(&apos;identity-list&apos;);</pre>

<p>Il vérifie ensuite si la fonction d&apos;identités contextuelles est activée dans le navigateur. Si ce n&apos;est pas le cas, des informations sur la façon de l&apos;activer sont ajoutées à la fenêtre contextuelle.</p>

<pre class="brush: json">if (browser.contextualIdentities === undefined) {
  div.innerText = &apos;browser.contextualIdentities not available. Check that the privacy.userContext.enabled pref is set to true, and reload the add-on.&apos;;
} else {</pre>

<p>Firefox s&apos;installe avec la fonctionnalité d&apos;identité contextuelle désactivée, elle est activée lorsqu&apos;une extension utilisant l&apos;API contextualIdentities est installée. Cependant, il est toujours possible pour l&apos;utilisateur de désactiver la fonctionnalité, en utilisant une option sur la page des préférences (about:preferences), d&apos;où la nécessité de la vérification.</p>

<p>Le script utilise maintenant contextualIdentities.query pour déterminer s&apos;il existe des identités contextuelles définies dans le navigateur. S&apos;il n&apos;y en a pas, un message est ajouté au popup et le script s&apos;arrête.</p>

<pre class="brush: json">  browser.contextualIdentities.query({})
    .then((identities) =&gt; {
      if (!identities.length) {
        div.innerText = &apos;No identities returned from the API.&apos;;
        return;
      }</pre>

<p>Si des identités contextuelles sont présentes — Firefox a quatre identités par défaut — le script parcourt chacune d&apos;elles en ajoutant son nom, stylisé dans la couleur choisie, à l&apos;élément &lt;div&gt;. La fonction <code>createOptions()</code> ajoute ensuite les options à “create” ou  “close all” à la &lt;div&gt; avant qu&apos;elle ne soit ajoutée au popup.</p>

<pre class="brush: json">     for (let identity of identities) {
       let row = document.createElement(&apos;div&apos;);
       let span = document.createElement(&apos;span&apos;);
       span.className = &apos;identity&apos;;
       span.innerText = identity.name;
       span.style = `color: ${identity.color}`;
       console.log(identity);
       row.appendChild(span);
       createOptions(row, identity);
       div.appendChild(row);
     }
  });
}

function createOptions(node, identity) {
  for (let option of [&apos;Create&apos;, &apos;Close All&apos;]) {
    let a = document.createElement(&apos;a&apos;);
    a.href = &apos;#&apos;;
    a.innerText = option;
    a.dataset.action = option.toLowerCase().replace(&apos; &apos;, &apos;-&apos;);
    a.dataset.identity = identity.cookieStoreId;
    a.addEventListener(&apos;click&apos;, eventHandler);
    node.appendChild(a);
  }
}</pre>

<p>Le script attend maintenant que l&apos;utilisateur sélectionne une option dans le popup.</p>

<pre class="brush: js">function eventHandler(event) {</pre>

<p>Si l&apos;utilisateur clique sur l&apos;option permettant de créer un onglet pour une identité, l&apos;un d&apos;entre eux est ouvert à l&apos;aide de tabs.create en transmettant l&apos;ID de cookie de l&apos;identité.</p>

<pre class="brush: json">  if (event.target.dataset.action == &apos;create&apos;) {
    browser.tabs.create({
      url: &apos;about:blank&apos;,
      cookieStoreId: event.target.dataset.identity
    });
  }</pre>

<p>Si l&apos;utilisateur sélectionne l&apos;option permettant de fermer tous les onglets pour l&apos;identité, le script exécute une tabs.query pour tous les onglets qui utilisent le cookie store de l&apos;identité. Le script passe ensuite cette liste d&apos;onglets à <code>tabs.remove</code>.</p>

<pre class="brush: json">  if (event.target.dataset.action == &apos;close-all&apos;) {
    browser.tabs.query({
      cookieStoreId: event.target.dataset.identity
    }).then((tabs) =&gt; {
      browser.tabs.remove(tabs.map((i) =&gt; i.id));
    });
  }
  event.preventDefault();
}</pre>

<h2 id="Apprendre_encore_plus">Apprendre encore plus</h2>

<p>Si vous voulez en savoir plus sur l&apos;API contextualIdentities, consultez :</p>

<ul>
 <li><a href="/fr/Add-ons/WebExtensions/API/contextualIdentities">contextualIdentities API reference</a>.</li>
 <li>code source de l&apos;extension <a href="https://github.com/mozilla/multi-account-containers/#readme">Multi-Account Containers</a>. C&apos;est le code pour l&apos;extension <a href="/fr/firefox/addon/multi-account-containers/">Firefox Multi-Account Containers</a>.
  <p>Cette extension fournit aux utilisateurs des fonctionnalités améliorées pour les identités contextuelles, telles que la possibilité de cliquer longuement sur le nouveau bouton de l&apos;onglet, puis de sélectionner l&apos;identité à utiliser dans le nouvel onglet. Il met vraiment en valeur les capacités offertes par les identités contextuelles et vaut le détour.</p>
  .</li>
</ul>
